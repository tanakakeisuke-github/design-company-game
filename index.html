<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾ç™ºå±•å›½</title>
<style>
/* â”€â”€ GOOGLE FONTS â”€â”€ */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=DotGothic16&display=swap');

/* â”€â”€ RESET & ROOT â”€â”€ */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;overflow:hidden;background:#f7f7f9;color:#18181b;font-family:'Inter','DotGothic16',sans-serif;font-size:13px;user-select:none}
button{font-family:inherit;cursor:pointer;border:none;background:none;outline:none;color:inherit}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:#f0f0f2}::-webkit-scrollbar-thumb{background:#d4d4d8;border-radius:4px}

:root{
  /* ã‚µãƒ¼ãƒ•ã‚§ã‚¹ */
  --bg:#f7f7f9;
  --bg1:#ffffff;
  --bg2:#fafafa;
  --bg3:#f4f4f6;
  --bg4:#ebebed;
  /* ãƒœãƒ¼ãƒ€ãƒ¼ */
  --bord:#e4e4e7;
  --bord2:#d1d1d6;
  /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ: ã‚¤ãƒ³ãƒ‡ã‚£ã‚´ */
  --acc:#4f46e5;
  --acc-lt:#ede9fe;
  --acc-md:#7c6ff7;
  /* ã‚»ã‚«ãƒ³ãƒ€ãƒª: ãƒ­ãƒ¼ã‚º */
  --acc2:#e11d48;
  --acc2-lt:#fff1f2;
  /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚«ãƒ©ãƒ¼ */
  --teal:#0d9488;
  --teal-lt:#f0fdf9;
  --gold:#b45309;
  --gold-lt:#fffbeb;
  --warn:#c2410c;
  --warn-lt:#fff7ed;
  --red:#dc2626;
  --red-lt:#fef2f2;
  --ok:#15803d;
  --ok-lt:#f0fdf4;
  --pur:#7e22ce;
  /* ãƒ†ã‚­ã‚¹ãƒˆ */
  --t1:#18181b;
  --t2:#52525b;
  --t3:#a1a1aa;
  --t4:#d4d4d8;
  /* ã‚·ãƒ£ãƒ‰ã‚¦ */
  --sh-s:0 1px 2px rgba(0,0,0,.05);
  --sh-m:0 2px 8px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);
  --sh-l:0 4px 16px rgba(0,0,0,.08),0 2px 4px rgba(0,0,0,.04);
}

/* â”€â”€ TITLE â”€â”€ */
#SCR_TITLE{
  position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:18px;
  background:linear-gradient(150deg,#fafaff 0%,#f0efff 50%,#faf5ff 100%);
}
#tcv{image-rendering:pixelated;border:1px solid var(--bord);box-shadow:var(--sh-l);border-radius:12px}
.t-logo{
  font-size:clamp(15px,3vw,22px);color:var(--acc);letter-spacing:1px;
  text-align:center;line-height:1.7;font-weight:700;font-family:'Inter',sans-serif;
}
.t-logo span{color:var(--t3);font-size:0.65em;font-weight:400;letter-spacing:2px}
.t-btn{
  background:var(--acc);border:none;color:#fff;padding:11px 42px;font-size:11px;
  letter-spacing:1px;transition:all .18s;border-radius:8px;font-weight:600;
  box-shadow:0 2px 8px rgba(79,70,229,.35);
}
.t-btn:hover{background:#4338ca;box-shadow:0 4px 16px rgba(79,70,229,.45);transform:translateY(-1px)}
.t-btn.sec{
  background:#fff;border:1px solid var(--bord2);color:var(--t2);
  box-shadow:var(--sh-s);font-weight:500;
}
.t-btn.sec:hover{background:var(--bg3);border-color:var(--bord);transform:none;box-shadow:var(--sh-s)}
.t-blink{font-size:9px;color:var(--t4);letter-spacing:4px;animation:blink 1.4s step-end infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
@keyframes glow{0%,100%{opacity:1}50%{opacity:.8}}

/* â”€â”€ LOADING â”€â”€ */
#SCR_LOAD{
  position:fixed;inset:0;background:#fff;display:flex;flex-direction:column;
  align-items:center;justify-content:center;z-index:2000;gap:16px;
}
.ld-bar{width:200px;height:2px;background:var(--bg4);border-radius:2px}
.ld-f{height:100%;background:var(--acc);animation:ldf 1.6s ease forwards;border-radius:2px}
@keyframes ldf{from{width:0}to{width:100%}}

/* â”€â”€ GAME SHELL â”€â”€ */
#GAME{display:none;height:100vh;flex-direction:column}

/* â”€â”€ HUD â”€â”€ */
#hud{
  background:var(--bg1);border-bottom:1px solid var(--bord);
  padding:6px 14px;display:flex;align-items:center;gap:6px;flex-shrink:0;flex-wrap:wrap;
  box-shadow:var(--sh-s);
}
.hud-co{
  font-size:11px;color:var(--acc);font-weight:700;letter-spacing:.3px;
  padding-right:10px;border-right:1px solid var(--bord);white-space:nowrap;
}
.hstats{display:flex;gap:4px;flex-wrap:wrap;flex:1}
.hs{
  display:flex;align-items:center;gap:4px;
  background:var(--bg3);border:1px solid var(--bord);
  padding:3px 8px;font-size:9px;border-radius:6px;
}
.hs-lbl{color:var(--t3);font-size:8px}
.hs-v{color:var(--t1);font-weight:600;min-width:26px}
.hs-v.g{color:var(--gold)}.hs-v.tl{color:var(--teal)}.hs-v.r{color:var(--red)}.hs-v.p{color:var(--acc2)}
.hs-v.blink{animation:blink .8s step-end infinite;color:var(--warn)}
/* æ—¥ä»˜ãƒãƒƒã‚¸ */
.hdate{
  display:flex;align-items:center;gap:5px;
  background:var(--acc-lt);border:1px solid #c7d2fe;
  padding:4px 10px;border-radius:6px;
  font-size:10px;font-weight:600;color:var(--acc);white-space:nowrap;margin-left:auto;
}
.hdate-day{font-size:8px;color:var(--acc-md);font-weight:400}
/* ãƒ•ã‚§ãƒ¼ã‚ºãƒãƒƒã‚¸ */
.hph{
  background:var(--acc);border-radius:6px;padding:4px 10px;
  font-size:8px;color:#fff;letter-spacing:.5px;font-weight:600;white-space:nowrap;
}

/* â”€â”€ NAV â”€â”€ */
#main{display:flex;flex:1;overflow:hidden}
#nav{
  width:52px;background:var(--bg1);border-right:1px solid var(--bord);
  display:flex;flex-direction:column;align-items:center;padding:6px 0;gap:2px;flex-shrink:0;
}
.nb{
  width:42px;height:42px;display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:2px;border-radius:8px;border:1px solid transparent;
  color:var(--t3);font-size:17px;transition:all .15s;position:relative;
}
.nb span{font-size:6px;color:var(--t4);font-family:'Inter',sans-serif;letter-spacing:.3px}
.nb:hover{background:var(--bg3);border-color:var(--bord);color:var(--t2)}
.nb:hover span{color:var(--t3)}
.nb.on{background:var(--acc-lt);border-color:#c7d2fe;color:var(--acc)}
.nb.on span{color:var(--acc)}
.nbadge{
  position:absolute;top:2px;right:2px;background:var(--red);color:#fff;
  font-size:6px;width:12px;height:12px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;font-weight:700;
}
.nsep{width:28px;height:1px;background:var(--bord);margin:3px 0}

/* â”€â”€ CONTENT & OFFICE â”€â”€ */
#content{flex:1;display:flex;flex-direction:column;overflow:hidden}
#owrap{
  height:240px;flex-shrink:0;background:#e8e8ec;
  border-bottom:1px solid var(--bord);position:relative;overflow:hidden;
}
#ocv{width:100%;height:100%;image-rendering:pixelated}
.olb{
  position:absolute;top:6px;left:8px;font-size:7px;
  color:rgba(79,70,229,.6);letter-spacing:2px;font-weight:600;
  background:rgba(255,255,255,.75);padding:2px 6px;border-radius:4px;backdrop-filter:blur(4px);
}

/* â”€â”€ PANELS â”€â”€ */
#panels{flex:1;overflow-y:auto;padding:12px 14px;background:var(--bg)}
.panel{display:none}.panel.on{display:block}

/* â”€â”€ SECTION HEADER â”€â”€ */
.sh{
  font-size:9px;color:var(--t3);letter-spacing:2px;text-transform:uppercase;
  border-bottom:1px solid var(--bord);padding-bottom:6px;margin-bottom:10px;
  display:flex;align-items:center;gap:6px;font-weight:600;
}
.sh::before{display:none}
.sh .ct{margin-left:auto;font-size:8px;color:var(--t4);letter-spacing:0}

/* â”€â”€ WARN BARS â”€â”€ */
.wbar{
  background:var(--red-lt);border:1px solid #fca5a5;color:var(--red);
  padding:5px 10px;font-size:8px;margin-bottom:8px;border-radius:6px;
  animation:blink 1.2s step-end infinite;display:none;
}
.ibar{
  background:var(--gold-lt);border:1px solid #fcd34d;color:var(--gold);
  padding:5px 10px;font-size:8px;margin-bottom:8px;border-radius:6px;display:none;
}

/* â”€â”€ TURN ROW â”€â”€ */
.trow{
  display:flex;align-items:center;gap:10px;
  background:var(--bg1);border:1px solid var(--bord);
  padding:10px 14px;margin-bottom:12px;border-radius:10px;
  box-shadow:var(--sh-s);
}
.tinfo{flex:1;font-size:9px;color:var(--t2);line-height:1.7}
.tinfo b{color:var(--t1);font-weight:600}
.tinfo .hint{font-size:8px;color:var(--t3)}
.tinfo .hint kbd{
  background:var(--bg3);border:1px solid var(--bord2);color:var(--t2);
  padding:0px 4px;border-radius:3px;font-size:8px;font-family:inherit;
}
.btn-turn{
  background:var(--acc);color:#fff;padding:9px 22px;font-size:10px;
  letter-spacing:.5px;transition:all .2s;border-radius:8px;font-weight:600;
  box-shadow:0 2px 8px rgba(79,70,229,.4);
  animation:turnpulse 2.5s ease-in-out infinite;
}
@keyframes turnpulse{
  0%,100%{box-shadow:0 2px 8px rgba(79,70,229,.35)}
  50%{box-shadow:0 4px 18px rgba(79,70,229,.55),0 0 0 3px rgba(79,70,229,.1)}
}
.btn-turn:hover{background:#4338ca;transform:translateY(-1px);box-shadow:0 4px 14px rgba(79,70,229,.5)}
.btn-turn:disabled{
  background:var(--bg4);color:var(--t4);box-shadow:none;
  transform:none;cursor:not-allowed;animation:none;
}

/* â”€â”€ DASH STATS GRID â”€â”€ */
.dgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:8px;margin-bottom:12px}
.dc{
  background:var(--bg1);border:1px solid var(--bord);padding:10px 12px;
  border-radius:8px;box-shadow:var(--sh-s);
}
.dc-l{font-size:7px;color:var(--t3);letter-spacing:1px;text-transform:uppercase;margin-bottom:3px;font-weight:600}
.dc-v{font-size:18px;font-weight:700;margin-bottom:3px;color:var(--t1)}
.dc-b{height:2px;background:var(--bg4);border-radius:2px}.dc-bf{height:100%;border-radius:2px;transition:width .4s}

/* â”€â”€ ACTIVE PROJECT â”€â”€ */
.ap{
  background:var(--bg1);border:1px solid var(--bord);padding:10px 12px;
  margin-bottom:7px;border-radius:8px;box-shadow:var(--sh-s);
  position:relative;overflow:hidden;transition:all .15s;
}
.ap:hover{border-color:var(--bord2);box-shadow:var(--sh-m)}
.ap::before{
  content:'';position:absolute;left:0;top:0;bottom:0;width:3px;
  background:var(--acc);border-radius:3px 0 0 3px;
}
.ap-h{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px}
.ap-n{font-size:10px;color:var(--t1);font-weight:600}
.ap-pct{font-size:16px;color:var(--acc);font-weight:700}
.ap-m{display:flex;gap:6px;font-size:7px;color:var(--t3);margin-bottom:6px;flex-wrap:wrap}
.apbar{height:4px;background:var(--bg4);overflow:hidden;border-radius:2px}
.apbf{height:100%;background:linear-gradient(90deg,var(--acc),var(--acc-md));border-radius:2px;transition:width .5s}
.apass{margin-top:7px;display:flex;gap:4px;flex-wrap:wrap;align-items:center}
.apal{font-size:7px;color:var(--t3)}
.ach{
  background:var(--bg3);border:1px solid var(--bord);padding:3px 8px;
  font-size:8px;color:var(--t2);cursor:pointer;transition:all .15s;border-radius:5px;font-weight:500;
}
.ach:hover{border-color:var(--teal);color:var(--teal);background:var(--teal-lt)}
.ach.sel{border-color:var(--teal);color:var(--teal);background:var(--teal-lt)}
.ach.bsy{opacity:.35;cursor:default;pointer-events:none}

/* â”€â”€ PROJECT CARDS â”€â”€ */
.pcgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:10px}
.pc{
  background:var(--bg1);border:1px solid var(--bord);padding:12px;
  border-radius:10px;box-shadow:var(--sh-s);transition:all .18s;
}
.pc:hover{box-shadow:var(--sh-m);border-color:var(--bord2);transform:translateY(-1px)}
.pc-h{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:5px}
.pc-ti{font-size:18px}.pc-ug{font-size:7px;color:var(--red);background:var(--red-lt);border:1px solid #fca5a5;padding:1px 5px;border-radius:4px;font-weight:600}
.pc-nm{font-size:10px;color:var(--t1);font-weight:600;margin-bottom:3px}
.pc-cl{font-size:8px;color:var(--t3);margin-bottom:7px}
.pc-st{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:8px}
.pct{background:var(--bg3);border:1px solid var(--bord);padding:2px 6px;font-size:7px;color:var(--t2);border-radius:4px;font-weight:500}
.pct.pri{background:var(--gold-lt);border-color:#fcd34d;color:var(--gold)}
.pct.dif{background:var(--warn-lt);border-color:#fed7aa;color:var(--warn)}
.pc-f{display:flex;align-items:center;justify-content:space-between;margin-top:6px;padding-top:8px;border-top:1px solid var(--bord)}
.pc-pr{font-size:12px;color:var(--gold);font-weight:700}
.btn-acc{
  background:var(--acc);color:#fff;padding:5px 12px;font-size:8px;
  border-radius:6px;font-weight:600;transition:all .15s;
}
.btn-acc:hover{background:#4338ca}.btn-acc:disabled{background:var(--bg4);color:var(--t4);cursor:not-allowed}

/* â”€â”€ STAFF â”€â”€ */
.scgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:10px}
.sc{
  background:var(--bg1);border:1px solid var(--bord);padding:12px;
  border-radius:10px;box-shadow:var(--sh-s);
}
.sc-h{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
.sc-i{font-size:20px}.sc-n{font-size:10px;color:var(--t1);font-weight:600;margin-bottom:1px}
.sc-r{font-size:7px;color:var(--t3);letter-spacing:.3px}
.sc-st{font-size:7px;padding:2px 6px;border-radius:10px;font-weight:600}
.sc-st.idle{background:var(--bg3);color:var(--t3)}
.sc-st.working{background:var(--acc-lt);color:var(--acc)}
.sc-bars{display:flex;flex-direction:column;gap:4px;margin-bottom:8px}
.sc-bar{display:flex;align-items:center;gap:6px;font-size:7px;color:var(--t3)}
.sc-bar-bg{flex:1;height:3px;background:var(--bg4);border-radius:2px}
.sc-bar-fg{height:100%;border-radius:2px;transition:width .4s}
.sc-bar-v{width:18px;text-align:right;color:var(--t2);font-weight:600}
.sc-f{display:flex;align-items:center;justify-content:space-between;padding-top:8px;border-top:1px solid var(--bord)}
.btn-fir{
  background:var(--red-lt);border:1px solid #fca5a5;color:var(--red);
  padding:3px 8px;font-size:7px;border-radius:5px;font-weight:500;transition:all .15s;
}
.btn-fir:hover{background:#fee2e2;border-color:var(--red)}

/* â”€â”€ HIRE â”€â”€ */
.hcgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:10px}
.hc{
  background:var(--bg1);border:1px solid var(--bord);padding:12px;
  border-radius:10px;box-shadow:var(--sh-s);transition:all .18s;
}
.hc:hover{box-shadow:var(--sh-m);border-color:var(--bord2)}
.hc-h{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:5px}
.hc-n{font-size:10px;color:var(--t1);font-weight:600}.hc-ro{font-size:7px;color:var(--t3);letter-spacing:.3px}
.hc-sl{font-size:11px;color:var(--gold);text-align:right;font-weight:700}
.hc-sl span{font-size:7px;color:var(--t3);font-weight:400}
.hc-risk{
  font-size:7px;color:var(--warn);
  background:var(--warn-lt);border:1px solid #fed7aa;
  padding:3px 7px;border-radius:4px;margin-bottom:8px;font-style:italic;
}
.hc-f{display:flex;align-items:center;justify-content:space-between;margin-top:8px;padding-top:8px;border-top:1px solid var(--bord)}
.hc-co{font-size:7px;color:var(--t3)}
.btn-hire{
  background:var(--ok);color:#fff;padding:5px 12px;font-size:8px;
  border-radius:6px;font-weight:600;transition:all .15s;
}
.btn-hire:hover{background:#15803d}.btn-hire:disabled{background:var(--bg4);color:var(--t4);cursor:not-allowed}

/* â”€â”€ TECH TREE â”€â”€ */
.tt-sec{margin-bottom:18px}
.tech-row{display:flex;gap:10px;flex-wrap:wrap;padding-left:8px}
.tn{
  background:var(--bg1);border:1.5px solid var(--bord);padding:10px 12px;
  min-width:105px;text-align:center;transition:all .18s;border-radius:10px;box-shadow:var(--sh-s);
}
.tn.un{border-color:var(--teal);background:var(--teal-lt)}
.tn.av{border-color:var(--acc);cursor:pointer;background:var(--acc-lt)}
.tn.av:hover{box-shadow:var(--sh-m);transform:translateY(-2px)}
.tn.lk{opacity:.4;cursor:not-allowed}
.tn-ic{font-size:20px;margin-bottom:3px}
.tn-nm{font-size:7px;color:var(--t1);letter-spacing:.3px;margin-bottom:2px;font-weight:600}
.tn-co{font-size:6px;color:var(--gold);font-weight:600}
.tn-st{font-size:6px;margin-top:2px;font-weight:600}
.tn.un .tn-st{color:var(--teal)}.tn.av .tn-st{color:var(--acc)}.tn.lk .tn-st{color:var(--t4)}
.tn-ef{font-size:5px;color:var(--acc2);margin-top:2px}

/* â”€â”€ PROGRESS â”€â”€ */
.phases{display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap}
.ph{
  flex:1;min-width:95px;background:var(--bg1);border:1px solid var(--bord);
  padding:10px 8px;text-align:center;border-radius:8px;box-shadow:var(--sh-s);
}
.ph.done{border-color:var(--teal);background:var(--teal-lt)}
.ph.cur{border-color:var(--acc);background:var(--acc-lt);animation:phg 2.5s ease infinite}
@keyframes phg{0%,100%{box-shadow:0 0 0 0 rgba(79,70,229,.15)}50%{box-shadow:0 0 0 4px rgba(79,70,229,.15)}}
.ph-n{font-size:20px;margin-bottom:3px}.ph-nm{font-size:7px;color:var(--t2);letter-spacing:.3px;font-weight:600}
.ph-s{font-size:6px;color:var(--t3);margin-top:2px}
.ofgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:8px;margin-bottom:14px}
.ofc{
  background:var(--bg1);border:1px solid var(--bord);padding:10px;
  border-radius:8px;box-shadow:var(--sh-s);transition:all .15s;
}
.ofc.cur{border-color:var(--acc);background:var(--acc-lt)}
.ofc.past{opacity:.5}
.ofc-ic{font-size:22px;margin-bottom:5px}.ofc-n{font-size:9px;color:var(--t1);font-weight:700;margin-bottom:2px}
.ofc-d{font-size:7px;color:var(--t3);line-height:1.6;margin-bottom:6px}
.ofc-f{display:flex;align-items:center;justify-content:space-between}.ofc-p{font-size:9px;color:var(--gold);font-weight:700}
.btn-up{
  background:var(--acc);color:#fff;padding:4px 10px;font-size:7px;
  border-radius:5px;font-weight:600;transition:all .15s;
}
.btn-up:hover{background:#4338ca}.btn-up:disabled{background:var(--bg4);color:var(--t4);cursor:not-allowed}
.statbox{
  background:var(--bg1);border:1px solid var(--bord);padding:12px;
  border-radius:8px;box-shadow:var(--sh-s);
  display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:6px;
}
.si{font-size:8px;color:var(--t2);display:flex;justify-content:space-between;padding:2px 0}
.si b{color:var(--t1);font-weight:600}

/* â”€â”€ LOG â”€â”€ */
.log{
  background:var(--bg1);border:1px solid var(--bord);padding:8px 10px;
  max-height:130px;overflow-y:auto;border-radius:8px;
  font-size:7px;line-height:2;
}
.le{display:flex;gap:5px;border-bottom:1px solid var(--bord);padding:1px 0}
.le:last-child{border-bottom:none}
.le-t{color:var(--t4);flex-shrink:0;font-weight:600}.le-x{color:var(--t2)}
.good .le-t{color:var(--ok)}.bad .le-t{color:var(--red)}.evt .le-t{color:var(--warn)}.sys .le-t{color:var(--acc)}

/* â”€â”€ MODALS â”€â”€ */
.mbg{position:fixed;inset:0;background:rgba(0,0,0,.4);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:500;padding:16px}
.mbg.open{display:flex}
.mbox{
  background:#fff;border:1px solid var(--bord);max-width:440px;width:100%;
  padding:24px;border-radius:16px;box-shadow:0 8px 40px rgba(0,0,0,.15);
  animation:mop .2s ease;
}
.mbox.danger{border-top:3px solid var(--red)}.mbox.success{border-top:3px solid var(--ok)}.mbox.warn{border-top:3px solid var(--warn)}
@keyframes mop{from{transform:scale(.94) translateY(10px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}
.mic{font-size:40px;text-align:center;display:block;margin-bottom:10px}
.mtt{font-size:14px;text-align:center;color:var(--t1);letter-spacing:.3px;margin-bottom:8px;line-height:1.4;font-weight:700}
.mbox.danger .mtt{color:var(--red)}.mbox.success .mtt{color:var(--ok)}.mbox.warn .mtt{color:var(--warn)}
.mds{font-size:9px;color:var(--t2);text-align:center;line-height:2;margin-bottom:16px;white-space:pre-line}
.mch-list{display:flex;flex-direction:column;gap:7px}
.mch{
  background:var(--bg3);border:1px solid var(--bord);padding:10px 13px;
  color:var(--t1);font-size:9px;cursor:pointer;transition:all .15s;
  display:flex;justify-content:space-between;align-items:center;gap:6px;
  text-align:left;font-family:inherit;width:100%;border-radius:8px;font-weight:500;
}
.mch:hover{border-color:var(--acc);background:var(--acc-lt);color:var(--acc)}
.mch .ef{font-size:7px;color:var(--t3);flex-shrink:0}.mch:hover .ef{color:var(--acc-md)}
.rev-box{border-top:3px solid var(--gold)}
.rev-st{font-size:22px;text-align:center;letter-spacing:5px;color:var(--gold);margin-bottom:6px}
.rev-cm{font-size:9px;text-align:center;color:var(--t2);font-style:italic;margin-bottom:12px;line-height:1.8}
.rev-ef{font-size:8px;text-align:center;color:var(--t3);margin-bottom:12px;line-height:2}
.btn-ok{
  display:block;width:100%;background:var(--bg3);border:1px solid var(--bord);
  color:var(--t2);padding:9px;font-size:9px;letter-spacing:1px;transition:all .15s;
  cursor:pointer;font-family:inherit;border-radius:8px;font-weight:500;
}
.btn-ok:hover{border-color:var(--gold);color:var(--gold);background:var(--gold-lt)}

/* â”€â”€ ENDING â”€â”€ */
#SCR_END{
  position:fixed;inset:0;background:linear-gradient(150deg,#f0efff 0%,#faf5ff 100%);
  display:none;flex-direction:column;align-items:center;justify-content:center;
  z-index:700;padding:20px;text-align:center;
}
#SCR_END.open{display:flex}
.end-t{font-size:clamp(16px,4vw,28px);letter-spacing:1px;margin-bottom:12px;line-height:1.4;font-weight:700;color:var(--t1)}
.end-s{max-width:440px;font-size:10px;color:var(--t2);line-height:2.2;margin-bottom:18px;white-space:pre-line}
.end-st{
  background:#fff;border:1px solid var(--bord);padding:14px 18px;margin-bottom:20px;
  font-size:9px;color:var(--t3);line-height:2;
  display:grid;grid-template-columns:1fr 1fr;gap:4px 18px;max-width:360px;
  border-radius:12px;box-shadow:var(--sh-m);
}
.end-st b{color:var(--t1);font-weight:700}
.btn-re{
  background:var(--acc);color:#fff;padding:11px 32px;font-size:11px;letter-spacing:.5px;
  transition:all .2s;font-family:inherit;cursor:pointer;border-radius:8px;font-weight:600;
  box-shadow:0 2px 8px rgba(79,70,229,.35);
}
.btn-re:hover{background:#4338ca;box-shadow:0 4px 14px rgba(79,70,229,.5);transform:translateY(-1px)}

/* â”€â”€ TURN PROGRESS (office overlay) â”€â”€ */
#turn-progress{
  position:absolute;bottom:0;left:0;right:0;height:22px;
  background:rgba(255,255,255,.85);backdrop-filter:blur(6px);
  border-top:1px solid rgba(0,0,0,.06);
  display:flex;align-items:center;gap:8px;padding:0 12px;pointer-events:none;
}
#tp-bar{height:4px;background:var(--bg4);flex:1;overflow:hidden;border-radius:2px}
#tp-bar::after{content:'';display:block;height:100%;background:linear-gradient(90deg,var(--acc),var(--acc-md));transition:width .4s ease;width:var(--tp,0%)}
#tp-txt{font-size:7px;color:var(--t3);white-space:nowrap;letter-spacing:.5px;min-width:100px;text-align:right;font-weight:500}

/* â”€â”€ AUTO CTRL â”€â”€ */
#auto-ctrl{position:absolute;top:6px;right:8px;display:flex;align-items:center;gap:4px}
#btn-auto{
  background:rgba(255,255,255,.9);border:1px solid var(--bord2);color:var(--t3);
  padding:3px 8px;font-size:7px;letter-spacing:.5px;transition:all .2s;cursor:pointer;
  border-radius:5px;font-weight:600;backdrop-filter:blur(4px);
}
#btn-auto.on{background:var(--acc-lt);border-color:#c7d2fe;color:var(--acc)}
#btn-auto:hover{border-color:var(--bord);color:var(--t2)}
#auto-speed{
  background:rgba(255,255,255,.9);border:1px solid var(--bord);color:var(--t2);
  font-size:7px;padding:3px 4px;font-family:inherit;outline:none;cursor:pointer;
  border-radius:5px;backdrop-filter:blur(4px);
}

/* â”€â”€ NOTIFS â”€â”€ */
#notifs{position:fixed;bottom:14px;right:14px;z-index:600;display:flex;flex-direction:column;gap:5px;pointer-events:none;max-width:270px}
.nf{
  background:#fff;border-left:3px solid var(--acc);padding:8px 11px;font-size:8px;
  box-shadow:var(--sh-l);animation:nfi .3s ease;border-radius:0 6px 6px 0;color:var(--t1);
}
.nf.out{animation:nfo .3s ease forwards}
.nf.danger{border-left-color:var(--red)}.nf.ok{border-left-color:var(--ok)}.nf.warn{border-left-color:var(--warn)}
@keyframes nfi{from{transform:translateX(110%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes nfo{to{transform:translateX(110%);opacity:0}}
.empty{font-size:9px;color:var(--t3);padding:16px;text-align:center;line-height:2}
</style>
</head>
<body>

<div id="SCR_LOAD">
  <div style="font-size:10px;color:var(--acc);letter-spacing:3px;font-weight:700;font-family:Inter,sans-serif">ãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾ç™ºå±•å›½</div>
  <div class="ld-bar"><div class="ld-f"></div></div>
  <div style="font-size:8px;color:var(--t3);letter-spacing:3px;animation:blink 1s step-end infinite">LOADING...</div>
</div>

<div id="SCR_TITLE" style="display:none">
  <canvas id="tcv" width="290" height="163"></canvas>
  <div class="t-logo">ãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾ç™ºå±•å›½<br><span>Design Company Simulator</span></div>
  <div style="font-size:7px;color:var(--t4);letter-spacing:2px">å…¨ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã«æ§ã’ã‚‹  Ver 2.0</div>
  <div style="display:flex;flex-direction:column;gap:8px;align-items:center">
    <button class="t-btn" onclick="G.newGame()">â–¶ NEW GAME</button>
    <button class="t-btn sec" onclick="G.load()">ã€€CONTINUEã€€</button>
    <button class="t-btn sec" onclick="G.howto()">ã€€HOW TO PLAYã€€</button>
  </div>
  <div class="t-blink">PRESS TO START</div>
</div>

<div id="GAME">
  <div id="hud">
    <div class="hud-co" id="hco">å€‹äººäº‹å‹™æ‰€</div>
    <div class="hstats">
      <div class="hs" title="è³‡é‡‘">ğŸ’° <span class="hs-lbl">è³‡é‡‘</span><span class="hs-v g" id="hmoney">Â¥38K</span></div>
      <div class="hs" title="è©•åˆ¤">â­ <span class="hs-lbl">è©•åˆ¤</span><span class="hs-v tl" id="hrep">12</span></div>
      <div class="hs" title="ç‚ä¸Š">ğŸ”¥ <span class="hs-lbl">ç‚ä¸Š</span><span class="hs-v r" id="hfire">0</span><span class="hs-lbl">%</span></div>
      <div class="hs" title="SNS">ğŸ“¢ <span class="hs-lbl">SNS</span><span class="hs-v p" id="hsns">84</span></div>
      <div class="hs" title="ç¤¾å“¡">ğŸ‘¥ <span class="hs-lbl">ç¤¾å“¡</span><span class="hs-v" id="hstaff">1</span><span class="hs-lbl">å</span></div>
      <div class="hs" title="ãƒ–ãƒ©ãƒƒã‚¯">ğŸ˜ˆ <span class="hs-lbl">BK</span><span class="hs-v" id="hblack">5</span><span class="hs-lbl">%</span></div>
    </div>
    <div class="hdate" id="hdate">ğŸ“… <span id="hdate-main">2025å¹´4æœˆ</span> <span class="hdate-day" id="hdate-day">ç¬¬1é€±</span></div>
    <div class="hph" id="hph">PHASE 0</div>
  </div>
  <div id="main">
    <div id="nav">
      <button class="nb on" id="nb-dash"   onclick="G.tab('dash')">ğŸ <span>HOME</span></button>
      <button class="nb"    id="nb-proj"   onclick="G.tab('proj')">ğŸ“‹<span>æ¡ˆä»¶</span><span class="nbadge" id="bdg-proj">0</span></button>
      <button class="nb"    id="nb-active" onclick="G.tab('active')">âš™ï¸<span>åˆ¶ä½œ</span></button>
      <div class="nsep"></div>
      <button class="nb"    id="nb-staff"  onclick="G.tab('staff')">ğŸ‘¥<span>ç¤¾å“¡</span></button>
      <button class="nb"    id="nb-hire"   onclick="G.tab('hire')">ğŸ“Œ<span>æ¡ç”¨</span></button>
      <div class="nsep"></div>
      <button class="nb"    id="nb-tech"   onclick="G.tab('tech')">ğŸ”¬<span>æŠ€è¡“</span></button>
      <button class="nb"    id="nb-prog"   onclick="G.tab('prog')">ğŸ“ˆ<span>æˆé•·</span></button>
      <div class="nsep" style="margin-top:auto"></div>
      <button class="nb" onclick="G.save()" title="ã‚»ãƒ¼ãƒ–" style="font-size:13px">ğŸ’¾<span>ä¿å­˜</span></button>
    </div>
    <div id="content">
      <div id="owrap">
  <canvas id="ocv"></canvas>
  <div class="olb" id="olb">COWORKING SPACE</div>
  <div class="otm" id="otm"></div>
  <div id="turn-progress">
    <div id="tp-bar"></div>
    <div id="tp-txt">é€±ã‚’é€²ã‚ã¦ãã ã•ã„</div>
  </div>
  <div id="auto-ctrl">
    <button id="btn-auto" class="on" onclick="G.toggleAuto()" title="è‡ªå‹•é€²è¡Œ">â–¶ AUTO</button>
    <select id="auto-speed" onchange="G.setAutoSpeed(this.value)" title="é€Ÿåº¦">
      <option value="4000">Ã—1 ã‚†ã£ãã‚Š</option>
      <option value="2500" selected>Ã—2 æ¨™æº–</option>
      <option value="1200">Ã—4 é€Ÿã„</option>
      <option value="500">Ã—8 çˆ†é€Ÿ</option>
    </select>
  </div>
</div>
      <div id="panels">
        <div class="panel on" id="pan-dash">
          <div class="wbar" id="wb-fire">âš  ç‚ä¸Šãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒå±é™ºåŸŸã§ã™ï¼</div>
          <div class="ibar" id="wb-money">ğŸ’° è³‡é‡‘ãŒå°‘ãªããªã£ã¦ã„ã¾ã™ï¼</div>
          <div class="trow">
            <div class="tinfo" id="tinfo"></div>
            <button class="btn-turn" id="btn-turn" onclick="G.nextTurn()">â–¶ æ¬¡ã®é€±ã¸</button>
          </div>
          <div class="sh">ä¼šç¤¾ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div>
          <div class="dgrid" id="dgrid"></div>
          <div class="sh">é€²è¡Œä¸­ã®æ¡ˆä»¶ <span class="ct" id="dash-cnt"></span></div>
          <div id="dash-ap"></div>
          <div class="sh" style="margin-top:9px">ã‚²ãƒ¼ãƒ ãƒ­ã‚°</div>
          <div class="log" id="glog"></div>
        </div>
        <div class="panel" id="pan-proj">
          <div class="sh">å—æ³¨å¯èƒ½ãªæ¡ˆä»¶ <span class="ct" id="proj-hint"></span></div>
          <div class="pcgrid" id="proj-list"></div>
        </div>
        <div class="panel" id="pan-active">
          <div class="sh">åˆ¶ä½œä¸­ã®æ¡ˆä»¶</div>
          <div id="active-list"></div>
        </div>
        <div class="panel" id="pan-staff">
          <div class="sh">ç¤¾å“¡ä¸€è¦§ <span class="ct" id="staff-cnt"></span></div>
          <div id="staff-list"></div>
        </div>
        <div class="panel" id="pan-hire">
          <div class="sh">æ±‚äººå€™è£œ</div>
          <div class="hcgrid" id="hire-list"></div>
        </div>
        <div class="panel" id="pan-tech">
          <div class="sh">æŠ€è¡“ãƒ„ãƒªãƒ¼</div>
          <p style="font-size:7px;color:var(--t3);margin-bottom:10px">æŠ€è¡“ç¿’å¾—ã§å—æ³¨ç¯„å›²ãƒ»å“è³ªãƒ»å˜ä¾¡ãŒå‘ä¸Šã€‚ã‚¯ãƒªãƒƒã‚¯ã§ç¿’å¾—ã€‚</p>
          <div id="tech-tree"></div>
        </div>
        <div class="panel" id="pan-prog">
          <div class="sh">ãƒ•ã‚§ãƒ¼ã‚ºé€²è¡Œ</div>
          <div class="phases" id="phases"></div>
          <div class="sh">ã‚ªãƒ•ã‚£ã‚¹</div>
          <div class="ofgrid" id="of-cards"></div>
          <div class="sh">çµ±è¨ˆ</div>
          <div class="statbox" id="statbox"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="mbg" id="modal-ev"><div class="mbox" id="mbox-ev"><span class="mic" id="mev-ic"></span><div class="mtt" id="mev-tt"></div><div class="mds" id="mev-ds"></div><div class="mch-list" id="mev-ch"></div></div></div>
<div class="mbg" id="modal-mod"><div class="mbox danger"><div style="font-size:7px;color:var(--red);letter-spacing:2px;text-align:center;margin-bottom:5px">ä¿®æ­£ä¾é ¼ <span id="mod-cnt">ç¬¬1å›</span></div><div class="mic" id="mod-face">ğŸ˜¤</div><div class="mtt" style="color:var(--red);font-size:11px" id="mod-pn"></div><div class="mds" id="mod-tx"></div><div class="mch-list" id="mod-ch"></div></div></div>
<div class="mbg" id="modal-rev"><div class="mbox rev-box"><div class="mtt" style="color:var(--gold)">ğŸ“¬ ç´å“å®Œäº†ï¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè©•ä¾¡</div><div class="rev-st" id="rev-st"></div><div class="rev-cm" id="rev-cm"></div><div class="rev-ef" id="rev-ef"></div><button class="btn-ok" id="btn-ok-rev">ã€€OKã€€</button></div></div>
<div id="SCR_END"><div class="end-t" id="end-t"></div><div class="end-s" id="end-s"></div><div class="end-st" id="end-st"></div><button class="btn-re" onclick="G.restart()">â–¶ ã‚‚ã†ä¸€å‘¨ã‚„ã‚‹</button></div>
<div id="notifs"></div>

<script>
'use strict';

// roundRect polyfill
if(!CanvasRenderingContext2D.prototype.roundRect){
  CanvasRenderingContext2D.prototype.roundRect=function(x,y,w,h,r){
    r=Math.min(r||0,w/2,h/2);
    this.beginPath();this.moveTo(x+r,y);
    this.lineTo(x+w-r,y);this.quadraticCurveTo(x+w,y,x+w,y+r);
    this.lineTo(x+w,y+h-r);this.quadraticCurveTo(x+w,y+h,x+w-r,y+h);
    this.lineTo(x+r,y+h);this.quadraticCurveTo(x,y+h,x,y+h-r);
    this.lineTo(x,y+r);this.quadraticCurveTo(x,y,x+r,y);
    this.closePath();
  };
}

// â”€â”€â”€ AUDIO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var ac=null;
function initAC(){try{ac=new(window.AudioContext||window.webkitAudioContext)();}catch(e){}}
function beep(freq,type,dur,vol,delay){
  if(!ac)return;
  try{var o=ac.createOscillator(),g=ac.createGain();o.connect(g);g.connect(ac.destination);
    o.type=type||'sine';o.frequency.value=freq;var t=ac.currentTime+(delay||0);
    g.gain.setValueAtTime(vol||0.1,t);g.gain.exponentialRampToValueAtTime(0.001,t+dur);
    o.start(t);o.stop(t+dur);}catch(e){}}
var SFX={
  coin:function(){beep(880,'sine',.1,.1);beep(1320,'sine',.15,.08,.08);},
  good:function(){[440,550,660].forEach(function(f,i){beep(f,'square',.1,.05,i*.06);});},
  bad:function(){beep(200,'sawtooth',.3,.1);},
  ev:function(){beep(660,'sine',.05,.1);beep(440,'sine',.15,.08,.06);},
  lvup:function(){[440,550,660,880].forEach(function(f,i){beep(f,'sine',.2,.1,i*.08);});},
  click:function(){beep(600,'square',.04,.04);},
  alert:function(){beep(330,'sawtooth',.1,.08);beep(220,'sawtooth',.15,.08,.1);},
  fanfare:function(){[523,659,784,1047].forEach(function(f,i){beep(f,'sine',.4,.1,i*.1);});}
};

// â”€â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fY(n){var a=Math.abs(n),s=n<0?'-':'';if(a>=10000000)return s+(a/10000000).toFixed(1)+'åƒä¸‡å††';if(a>=1000000)return s+Math.round(a/10000)+'ä¸‡å††';if(a>=10000)return s+(a/10000).toFixed(1)+'ä¸‡å††';return s+a.toLocaleString()+'å††';}
function fM(n){return Math.abs(n)>=10000?Math.round(n/1000)+'K':n.toLocaleString();}
function ri(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function pick(a){return a[Math.floor(Math.random()*a.length)];}
function clamp(v,lo,hi){return Math.max(lo,Math.min(hi,v));}
function shuffle(a){var b=a.slice();for(var i=b.length-1;i>0;i--){var j=ri(0,i);var t=b[i];b[i]=b[j];b[j]=t;}return b;}
function esc(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
function q(id){return document.getElementById(id);}

// â”€â”€â”€ NOTIFY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function notify(msg,type,dur){
  var area=q('notifs');var el=document.createElement('div');el.className='nf '+(type||'');el.textContent=msg;area.appendChild(el);
  setTimeout(function(){el.classList.add('out');setTimeout(function(){if(el.parentNode)el.parentNode.removeChild(el);},350);},(dur||3000));
}

// â”€â”€â”€ STATIC DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var PTYPES=[
  {id:'logo',  lb:'ãƒ­ã‚´',        ic:'ğŸ”¤',css:'logo', base:80000,  days:3, ph:0,sk:['design']},
  {id:'meishi',lb:'ååˆº',        ic:'ğŸ’³',css:'logo', base:30000,  days:2, ph:0,sk:['design']},
  {id:'lp',    lb:'LP',          ic:'ğŸ–¥ï¸',css:'lp',  base:200000, days:5, ph:0,sk:['design','ui']},
  {id:'banner',lb:'ãƒãƒŠãƒ¼',      ic:'ğŸ–¼ï¸',css:'lp',  base:50000,  days:2, ph:0,sk:['design']},
  {id:'app',   lb:'ã‚¢ãƒ—ãƒªUI',    ic:'ğŸ“±',css:'app', base:800000, days:10,ph:1,sk:['ui','logic']},
  {id:'web',   lb:'Webã‚µãƒ¼ãƒ“ã‚¹', ic:'ğŸŒ',css:'web', base:1500000,days:14,ph:1,sk:['ui','logic','design']},
  {id:'brand', lb:'ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°',ic:'ğŸ’',css:'brand',base:3000000,days:18,ph:2,sk:['design','comm']},
  {id:'ai',    lb:'AIãƒ—ãƒ­ãƒ€ã‚¯ãƒˆ',ic:'ğŸ¤–',css:'ai',  base:5000000,days:22,ph:3,sk:['logic','ui','design']},
];
var CTYPES=[
  {id:'god',  lb:'ç¥ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ',        cls:'cgod',  ic:'ğŸ˜‡',mr:5, pm:1.3, rg:4,rl:-1,desc:'äºˆç®—æ½¤æ²¢ãƒ»ä¿®æ­£å°‘ãƒ»äººæ ¼è€…'},
  {id:'norm', lb:'æ™®é€šã®ä¼šç¤¾',             cls:'cnorm', ic:'ğŸ¢',mr:28,pm:1.0, rg:1,rl:1, desc:'å¯ã‚‚ãªãä¸å¯ã‚‚ãªã'},
  {id:'start',lb:'æ„è­˜é«˜ã„ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—',cls:'cstart',ic:'ğŸš€',mr:52,pm:0.78,rg:2,rl:2, desc:'ä¸–ç•Œã‚’å¤‰ãˆãŸã„ãŒäºˆç®—ä½ã„'},
  {id:'agency',lb:'å¤§æ‰‹ä»£ç†åº—çµŒç”±',        cls:'cagency',ic:'ğŸ˜¤',mr:62,pm:0.85,rg:1,rl:3, desc:'ä¸­é–“ãƒãƒ¼ã‚¸ãƒ³å¤§ãƒ»æ‹…å½“ã‚³ãƒ­ã‚³ãƒ­'},
  {id:'pres', lb:'åœ°æ–¹ã®ç¤¾é•·',             cls:'cpres', ic:'ğŸ‘´',mr:72,pm:1.1, rg:1,rl:2, desc:'ã‚·ãƒ³ãƒ—ãƒ«ã«â†’è±ªè¯ã« ã‚’ç¹°ã‚Šè¿”ã™'},
  {id:'gov',  lb:'ãŠå½¹æ‰€',                 cls:'cgov',  ic:'ğŸ“„',mr:38,pm:1.4, rg:0,rl:0, desc:'ä»•æ§˜æ›¸250ãƒšãƒ¼ã‚¸ãƒ»MSæ˜æœæŒ‡å®š'},
  {id:'vnt',  lb:'ã‚·ãƒªãƒ¼ã‚ºAã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—',cls:'cvnt',  ic:'ğŸ’¼',mr:42,pm:1.15,rg:3,rl:1, desc:'è³‡é‡‘èª¿é”æ¸ˆã¿ãƒ»ã§ã‚‚æ€¥ã'},
  {id:'indie',lb:'å€‹äººäº‹æ¥­ä¸»',             cls:'cind',  ic:'ğŸ™‹',mr:55,pm:0.5, rg:1,rl:1, desc:'äºˆç®—5ä¸‡ãƒ»è¦æ±‚100ä¸‡ç›¸å½“'},
];
var PNAMES={
  logo:  ['åœ°æ–¹è“å­ãƒ¡ãƒ¼ã‚«ãƒ¼ã®ãƒ­ã‚´','ã‚«ãƒ•ã‚§ã®ãƒ­ã‚´ãƒªãƒ‡ã‚¶ã‚¤ãƒ³','ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ­ã‚´','åŒ»ç™‚ã‚¯ãƒªãƒ‹ãƒƒã‚¯ã‚·ãƒ³ãƒœãƒ«','ä¸å‹•ç”£ä¼šç¤¾ãƒ­ã‚´','ãƒ¨ã‚¬ã‚¹ã‚¿ã‚¸ã‚ªã®ãƒãƒ¼ã‚¯'],
  meishi:['ç¨ç†å£«ã®ååˆº200æš','ãƒ•ãƒªãƒ¼ã‚³ãƒ³ã‚µãƒ«ã®ååˆº','çµŒå–¶è€…ååˆºãƒªãƒ‡ã‚¶ã‚¤ãƒ³'],
  lp:    ['æ–°å•†å“ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸','ã‚»ãƒŸãƒŠãƒ¼é›†å®¢LP','æ¡ç”¨ã‚µã‚¤ãƒˆLP','ECãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸'],
  banner:['Googleåºƒå‘ŠãƒãƒŠãƒ¼ä¸€å¼','SNSåºƒå‘ŠãƒãƒŠãƒ¼ã‚»ãƒƒãƒˆ','ãƒ¡ãƒ«ãƒã‚¬ãƒ˜ãƒƒãƒ€ãƒ¼'],
  app:   ['ãƒ•ãƒ¼ãƒ‰ãƒ‡ãƒªãƒãƒªãƒ¼ã‚¢ãƒ—ãƒªUI','åŒ»ç™‚äºˆç´„ã‚¢ãƒ—ãƒªUI','ãƒ•ã‚£ãƒ³ãƒ†ãƒƒã‚¯ã‚¢ãƒ—ãƒªUI','ã‚®ã‚°ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¢ãƒ—ãƒªUI'],
  web:   ['BtoB SaaSç®¡ç†ç”»é¢','ãƒãƒƒãƒãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹UI','ECãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ UI'],
  brand: ['å¤§æ‰‹é£Ÿå“ãƒ¡ãƒ¼ã‚«ãƒ¼ãƒªãƒ–ãƒ©ãƒ³ãƒ‰','ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ–ãƒ©ãƒ³ãƒ‰æ§‹ç¯‰','è‡ªæ²»ä½“ã‚·ãƒ†ã‚£ãƒ–ãƒ©ãƒ³ãƒ‰'],
  ai:    ['AIæ­è¼‰ãƒ„ãƒ¼ãƒ«ã®UX','ç”ŸæˆAIã‚µãƒ¼ãƒ“ã‚¹UI','AIã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥IF'],
};
var MODS=[
  {tx:'ã€Œå…¨ä½“çš„ã«ã‚‚ã£ã¨ãƒãƒƒãƒ—ã«ã—ã¦ãã ã•ã„ã€', em:'ğŸŒˆ',dm:-8, at:'ã‹ã—ã“ã¾ã‚Šã¾ã—ãŸâ€¦',rt:'ãƒãƒƒãƒ—ã¨ã¯ã©ã†ã„ã†æ„å‘³ã§ã—ã‚‡ã†ã‹ï¼Ÿ',rp:-6},
  {tx:'ã€Œãªã‚“ã‹ã¡ã‚‡ã£ã¨é•ã†ã‚“ã§ã™ã‚ˆã­ã€œã€',      em:'ğŸ˜‘',dm:-10,at:'ä¿®æ­£ã—ã¾ã™',rt:'å…·ä½“çš„ã«ã©ã“ãŒé•ã„ã¾ã™ã‹ï¼Ÿ',rp:-3},
  {tx:'ã€Œå‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã«æˆ»ã—ã¦ãã ã•ã„ã€',         em:'ğŸ˜¤',dm:-15,at:'ã‚‚ã¡ã‚ã‚“ã§ã™ï¼ˆ2é€±é–“è¿”ã—ã¦ï¼‰',rt:'ãã‚Œã¯é›£ã—ã„ã§ã™â€¦',rp:-10},
  {tx:'ã€Œãƒ­ã‚´ã‚’100æ¡ˆå‡ºã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿã€',     em:'ğŸ’€',dm:-25,at:'ã¯ã„â€¦ï¼ˆå»ƒäººç¢ºå®šï¼‰',rt:'50æ¡ˆã§ã¯ã„ã‹ãŒã§ã—ã‚‡ã†',rp:-12},
  {tx:'ã€Œæ¯å­ãŒã‚‚ã£ã¨è±ªè¯ã«ã¨è¨€ã£ã¦ã¾ã™ã€',       em:'ğŸ‘¨â€ğŸ‘¦',dm:-12,at:'è±ªè¯ã«ã—ã¾ã™',rt:'ç¤¾é•·ã®ã”åˆ¤æ–­ã«ãŠä»»ã›ã‚’',rp:-15},
  {tx:'ã€Œæ‹…å½“è€…ãŒå¤‰ã‚ã‚Šã¾ã—ãŸã€‚å¼•ãç¶™ãã‚¼ãƒ­ã§ã™ã€',em:'ğŸ˜­',dm:-20,at:'æœ€åˆã‹ã‚‰èª¬æ˜ã—ã¾ã™',rt:'å¼•ãç¶™ãè³‡æ–™ã‚’ãã ã•ã„',rp:-5},
  {tx:'ã€Œå‰ã¨é•ã†æ–¹å‘ã§å…¨éƒ¨ã‚„ã‚Šç›´ã—ã§ã€',         em:'ğŸ”„',dm:-30,at:'ã¯ã„â€¦ï¼ˆæ·±å¤œç¢ºå®šï¼‰',rt:'è¿½åŠ è²»ç”¨ãŒç™ºç”Ÿã—ã¾ã™',rp:-10},
  {tx:'ã€Œã‚·ãƒ³ãƒ—ãƒ«ã«â†’è±ªè¯ã«â†’ã‚„ã£ã±ã‚Šã‚·ãƒ³ãƒ—ãƒ«ã«ã€',em:'ğŸ”',dm:-35,at:'äº†è§£ã§ã™ï¼ˆä¸‰å¾€å¾©ç›®ï¼‰',rt:'æ–¹å‘æ€§ã‚’æ±ºã‚ã¦ã„ãŸã ããŸã„',rp:-8},
  {tx:'ã€Œãªã‚“ã‹ãã£ã¨ã“ãªã„ã‚“ã§ã™ã€',             em:'ğŸ¤”',dm:-8, at:'ãã£ã¨ãã‚‹æ–¹å‘ã§',rt:'å…·ä½“çš„ãªFBã‚’ãŠé¡˜ã„ã—ã¾ã™',rp:-3},
  {tx:'ã€Œç„¡æ–™ã§ã‚‚ã†3æ¡ˆä½œã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿã€',    em:'ğŸ’¸',dm:-18,at:'ã‚ã‹ã‚Šã¾ã—ãŸï¼ˆæ¶™ï¼‰',rt:'è¿½åŠ æ¡ˆä»¶ã¨ã—ã¦å¯¾å¿œã—ã¾ã™',rp:-8},
  {tx:'ã€Œä»–ç¤¾ã«é ¼ã‚‚ã†ã‹è¿·ã£ã¦ã¾ã™ã€',             em:'ğŸ˜¨',dm:-12,at:'å€¤å¼•ãã—ã¾ã™',rt:'ãœã²ã”æ¤œè¨ãã ã•ã„',rp:-20},
  {tx:'ã€Œæ˜¨æ—¥é€ã£ãŸãƒ‡ãƒ¼ã‚¿ã€å·®ã—æ›¿ãˆã§ã€ï¼ˆç´å“å¾Œï¼‰',em:'ğŸ˜¤',dm:-20,at:'å¯¾å¿œã—ã¾ã™ï¼ˆç„¡æ–™ã§ï¼‰',rt:'è¿½åŠ æ–™é‡‘ãŒç™ºç”Ÿã—ã¾ã™',rp:-12},
];
var EVTS=[
  {id:'figma_down',ic:'ğŸ’€',ty:'danger',tt:'FigmaãŒè½ã¡ãŸï¼',
   ds:'ç· ã‚åˆ‡ã‚Š3æ™‚é–“å‰ã€Figmaã®ã‚µãƒ¼ãƒãƒ¼ãŒãƒ€ã‚¦ãƒ³ã€‚\nã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ã¯ã€Œinvestigatingã€ã€‚',
   ch:[{tx:'Sketchã§ä½œæ¥­ç¶šè¡Œ',ef:'å…¨ãƒ¡ãƒ³ã‚¿ãƒ«-5',fn:function(){G.s.staff.forEach(function(s){s.mental=clamp(s.mental-5,0,100);});notify('Sketchã§å‡Œãã¾ã™â€¦','warn');}},
       {tx:'å¾©æ—§ã‚’å¾…ã¤ï¼ˆãã‚ãã‚ï¼‰',ef:'å…¨ãƒ¡ãƒ³ã‚¿ãƒ«-12',fn:function(){G.s.staff.forEach(function(s){s.mental=clamp(s.mental-12,0,100);});addLog('Figmaå¾©æ—§å¾…ã¡ä¸­â€¦å…¨å“¡ç²¾ç¥æ¶ˆè€—','bad');}}]},
  {id:'client_bomb',ic:'ğŸ’¢',ty:'danger',tt:'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒçˆ†ç™ºï¼',
   ds:'æ‹…å½“è€…ã‹ã‚‰çªç„¶ã€é•·æ–‡ã®æ€’ã‚Šã®ãƒ¡ãƒ¼ãƒ«ãŒå±Šãã¾ã—ãŸã€‚\nç†ç”±ãŒã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã€‚ã§ã‚‚æ¿€ã—ãæ€’ã£ã¦ã„ã¾ã™ã€‚',
   ch:[{tx:'è¬ã‚Šå€’ã™ï¼ˆåœŸä¸‹åº§ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰',ef:'è©•åˆ¤-5ã€ãƒ¡ãƒ³ã‚¿ãƒ«-15',fn:function(){G.s.rep=clamp(G.s.rep-5,0,100);G.s.staff.forEach(function(s){s.mental=clamp(s.mental-15,0,100);});addLog('ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¬ç½ªã€‚ç–²å¼Šã€‚','bad');}},
       {tx:'å†·é™ã«äº‹å®Ÿç¢ºèªã™ã‚‹',ef:'è©•åˆ¤-2ã€æ”¹å–„ã®å¯èƒ½æ€§',fn:function(){G.s.rep=clamp(G.s.rep-2,0,100);notify('å†·é™å¯¾å¿œã€‚äº‹æ…‹ãŒè½ã¡ç€ã„ãŸã€‚','ok');}}]},
  {id:'inf_mod',ic:'â™¾ï¸',ty:'danger',tt:'ç„¡é™ä¿®æ­£åœ°ç„çªå…¥',
   ds:'ã€Œã‚‚ã†ä¸€å£°ã€\nã€Œã‚‚ã†ä¸€å£°ã€\nã€Œã‚‚ã†ä¸€å£°ã€\nã“ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€æ­¢ã¾ã‚‹æ°—ãŒã‚ã‚Šã¾ã›ã‚“ã€‚',
   ch:[{tx:'å—ã‘ç¶šã‘ã‚‹ï¼ˆå»ƒäººãƒ«ãƒ¼ãƒˆï¼‰',ef:'å…¨ãƒ¡ãƒ³ã‚¿ãƒ«-30ã€ãƒ–ãƒ©ãƒƒã‚¯+10',fn:function(){G.s.staff.forEach(function(s){s.mental=clamp(s.mental-30,0,100);});G.s.totalMods+=10;G.s.black=clamp(G.s.black+10,0,100);addLog('ç„¡é™ä¿®æ­£åœ°ç„â€¦ç¤¾å“¡ãŒå£Šã‚Œã¦ã„ã','bad');SFX.bad();}},
       {tx:'è¿½åŠ è²»ç”¨ã‚’è«‹æ±‚ã™ã‚‹',ef:'+10ä¸‡å††ã€è©•åˆ¤-5',fn:function(){G.s.money+=100000;G.s.rep=clamp(G.s.rep-5,0,100);addLog('è¿½åŠ è²»ç”¨è«‹æ±‚ã§ä¿®æ­£ã‚’æ‰“ã¡åˆ‡ã£ãŸã€‚','good');}}]},
  {id:'quit',ic:'ğŸš¶',ty:'warn',tt:'ç¤¾å“¡ãŒé€€è·ã‚’ç”³ã—å‡ºãŸ',
   ds:'ã€Œå°‘ã—ãŠè©±ãŒã‚ã‚‹ã‚“ã§ã™ãŒâ€¦ã€\nç¤¾å“¡ã®1äººãŒã€é™ã‹ã«é€€è·ã‚’ç”³ã—å‡ºã¾ã—ãŸã€‚',
   ch:[{tx:'çµ¦ä¸ã‚’ä¸Šã’ã¦å¼•ãæ­¢ã‚ã‚‹',ef:'-20ä¸‡å††ã€å¼•ãæ­¢ã‚',fn:function(){if(G.s.money>=200000){G.s.money-=200000;notify('çµ¦ä¸UPã§å¼•ãæ­¢ã‚æˆåŠŸï¼','ok');}else{fireRandom();notify('è³‡é‡‘ä¸è¶³ã§å¼•ãæ­¢ã‚ã‚‰ã‚Œãªã‹ã£ãŸâ€¦','danger');}}},
       {tx:'å¿«ãé€ã‚Šå‡ºã™',ef:'è©•åˆ¤-3ã€äººå“¡-1',fn:function(){fireRandom();addLog('ç¤¾å“¡ãŒæ—…ç«‹ã£ãŸã€‚','bad');}},
       {tx:'æ¥­å‹™æ”¹å–„ã‚’ç´„æŸã™ã‚‹',ef:'ãƒ–ãƒ©ãƒƒã‚¯-10ã€æˆåŠŸç‡50%',fn:function(){if(Math.random()<0.5){G.s.black=clamp(G.s.black-10,0,100);notify('æ”¹å–„ç´„æŸã§å¼•ãæ­¢ã‚æˆåŠŸï¼','ok');}else{fireRandom();notify('ãã‚Œã§ã‚‚å»ã£ã¦ã„ã£ãŸâ€¦','danger');}}}]},
  {id:'font_acc',ic:'ğŸ”¤',ty:'danger',tt:'ãƒ•ã‚©ãƒ³ãƒˆäº‹æ•…ç™ºç”Ÿï¼',
   ds:'ç´å“ãƒ‡ãƒ¼ã‚¿ã«æœªè³¼å…¥ã®å•†ç”¨ãƒ•ã‚©ãƒ³ãƒˆãŒæ··å…¥ã—ã¦ã„ã¾ã—ãŸã€‚\nã€Œå°åˆ·ã§ãã¾ã›ã‚“ã€ã¨é€£çµ¡ãŒæ¥ã¦ã„ã¾ã™ã€‚',
   ch:[{tx:'å³åº§ã«ä¿®æ­£ç‰ˆã‚’é€ã‚‹',ef:'ãƒ¡ãƒ³ã‚¿ãƒ«-10ã€-3ä¸‡å††',fn:function(){G.s.staff.forEach(function(s){s.mental=clamp(s.mental-10,0,100);});G.s.money-=30000;addLog('ãƒ•ã‚©ãƒ³ãƒˆäº‹æ•…å¯¾å¿œã€‚å‡ºè²»ã‚ã‚Šã€‚','bad');}},
       {tx:'ãƒ•ãƒªãƒ¼ãƒ•ã‚©ãƒ³ãƒˆã«å·®ã—æ›¿ãˆ',ef:'å“è³ªãƒ€ã‚¦ãƒ³ã€è©•åˆ¤-5',fn:function(){G.s.rep=clamp(G.s.rep-5,0,100);addLog('ãƒ•ãƒªãƒ¼ãƒ•ã‚©ãƒ³ãƒˆå·®ã—æ›¿ãˆã€‚å“è³ªå¦¥å”ã€‚','bad');}}]},
  {id:'fire_sns',ic:'ğŸ”¥',ty:'danger',tt:'SNSç‚ä¸Šç™ºç”Ÿï¼',
   ds:'ã€Œã“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã²ã©ããªã„ï¼Ÿã€ã®å£°ãŒXã§åºƒã¾ã£ã¦ã„ã¾ã™ã€‚\nãƒˆãƒ¬ãƒ³ãƒ‰ã«è¼‰ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚',
   ch:[{tx:'è¬ç½ªæ–‡ã‚’ä¸å¯§ã«å‡ºã™',ef:'ç‚ä¸Š-15ã€è©•åˆ¤-10',fn:function(){G.s.fire=clamp(G.s.fire-15,0,100);G.s.rep=clamp(G.s.rep-10,0,100);addLog('è¬ç½ªæ–‡å…¬é–‹ã€‚ç‚ä¸ŠãŒå°‘ã—åã¾ã£ãŸã€‚','bad');}},
       {tx:'å®Œå…¨æ²ˆé»™ã§ä¹—ã‚Šåˆ‡ã‚‹',ef:'ç‚ä¸Š+8',fn:function(){G.s.fire=clamp(G.s.fire+8,0,100);addLog('æ²ˆé»™ä½œæˆ¦ã€‚ã¾ã ç‡ƒãˆã¦ã„ã‚‹â€¦','bad');}},
       {tx:'ãƒ‡ã‚¶ã‚¤ãƒ³ã®æ„å›³ã‚’èª¬æ˜ã™ã‚‹',ef:'æˆåŠŸã‹ç‚ä¸Šã‹50/50',fn:function(){if(Math.random()<0.45){G.s.fire=clamp(G.s.fire-20,0,100);G.s.rep=clamp(G.s.rep+5,0,100);notify('èª¬æ˜ãŒå…±æ„Ÿã‚’å‘¼ã³ç‚ä¸Šé®ç«ï¼','ok');}else{G.s.fire=clamp(G.s.fire+15,0,100);notify('ã•ã‚‰ã«ç‚ä¸Šã—ã¦ã—ã¾ã£ãŸâ€¦','danger');}}}]},
  {id:'sns_buzz',ic:'ğŸš€',ty:'success',tt:'SNSã§ãƒã‚ºã£ãŸï¼',
   ds:'ç´å“ã—ãŸæ¡ˆä»¶ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãŒSNSã§å¤§ãããƒã‚ºã‚Šã¾ã—ãŸï¼\nãƒ‡ã‚¶ã‚¤ãƒ³å¥½ãã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç¶šã€…ã¨ãƒªãƒã‚¹ãƒˆã€‚',
   ch:[{tx:'ç©æ¥µçš„ã«æ‹¡æ•£ã™ã‚‹',ef:'SNS+500ã€è©•åˆ¤+8',fn:function(){G.s.sns+=500;G.s.rep=clamp(G.s.rep+8,0,100);addLog('SNSãƒã‚ºã§èªçŸ¥æ€¥æ‹¡å¤§ï¼','good');SFX.good();}},
       {tx:'é™ã‹ã«å–œã¶',ef:'SNS+150ã€è©•åˆ¤+3',fn:function(){G.s.sns+=150;G.s.rep=clamp(G.s.rep+3,0,100);addLog('é™ã‹ã«ãƒã‚ºã‚Šã‚’äº«å—ã—ãŸã€‚','good');}}]},
  {id:'award',ic:'ğŸ†',ty:'success',tt:'ãƒ‡ã‚¶ã‚¤ãƒ³è³ã‚’å—è³ï¼',
   ds:'ã‚°ãƒƒãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³è³ã®ä¸€æ¬¡å¯©æŸ»ã‚’é€šéã—ã¾ã—ãŸï¼',
   ch:[{tx:'ãƒ—ãƒ¬ã‚¹ãƒªãƒªãƒ¼ã‚¹ã‚’ç©æ¥µå±•é–‹',ef:'è©•åˆ¤+25ã€SNS+400',fn:function(){G.s.rep=clamp(G.s.rep+25,0,100);G.s.sns+=400;G.s.awards++;addLog('ã‚°ãƒƒãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³è³å—è³ï¼æ¥­ç•Œé¨’ç„¶ï¼','good');SFX.fanfare();}},
       {tx:'å®Ÿç¸¾ã¨ã—ã¦æ·¡ã€…ã¨è¨˜éŒ²',ef:'è©•åˆ¤+12',fn:function(){G.s.rep=clamp(G.s.rep+12,0,100);G.s.awards++;addLog('ãƒ‡ã‚¶ã‚¤ãƒ³è³å—è³ã€‚å®Ÿç¸¾ã¨ã—ã¦è¨˜éŒ²ã€‚','good');}}]},
  {id:'god_cli',ic:'ğŸ˜‡',ty:'success',tt:'ç¥ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç™»å ´ï¼',
   ds:'ã€Œäºˆç®—ã¯ååˆ†ã‚ã‚Šã¾ã™ã€‚ä¿®æ­£ã‚‚ã»ã¼ã—ã¾ã›ã‚“ã€‚ã€\nå¤¢ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒç¾ã‚Œã¾ã—ãŸã€‚',
   ch:[{tx:'ãœã²ãŠé¡˜ã„ã—ã¾ã™ï¼',ef:'é«˜é¡æ¡ˆä»¶+300ã€œ500ä¸‡å††',fn:function(){var e=3000000+ri(0,2000000);G.s.money+=e;G.s.rep=clamp(G.s.rep+10,0,100);addLog('ç¥ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨å¥‘ç´„ï¼'+fY(e)+'ï¼','good');SFX.fanfare();}}]},
  {id:'media',ic:'ğŸ“°',ty:'success',tt:'ãƒ¡ãƒ‡ã‚£ã‚¢å–æä¾é ¼ï¼',
   ds:'ãƒ‡ã‚¶ã‚¤ãƒ³å°‚é–€ãƒ¡ãƒ‡ã‚£ã‚¢ã‹ã‚‰å–æã®ç”³ã—è¾¼ã¿ãŒæ¥ã¾ã—ãŸã€‚',
   ch:[{tx:'å—ã‘ã‚‹ï¼ˆä»ŠãŒãƒãƒ£ãƒ³ã‚¹ï¼‰',ef:'è©•åˆ¤+22ã€SNS+300',fn:function(){G.s.rep=clamp(G.s.rep+22,0,100);G.s.sns+=300;addLog('ãƒ¡ãƒ‡ã‚£ã‚¢å–ææ²è¼‰ã€‚èªçŸ¥åº¦çˆ†ä¸ŠãŒã‚Šã€‚','good');SFX.good();}},
       {tx:'ä»Šã¯å¿™ã—ã„ã®ã§æ–­ã‚‹',ef:'ãƒãƒ£ãƒ³ã‚¹ã‚’é€ƒã™',fn:function(){notify('æ¬¡ã®æ©Ÿä¼šã‚’å¾…ã¨ã†â€¦','warn');}}]},
  {id:'study',ic:'ğŸ“š',ty:'success',tt:'ç¤¾å†…å‹‰å¼·ä¼šãŒç››ã‚Šä¸ŠãŒã£ãŸï¼',
   ds:'è‡ªä¸»çš„ãªå‹‰å¼·ä¼šãŒå§‹ã¾ã‚Šã€å…¨ç¤¾å“¡ãŒç†±å¿ƒã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚',
   ch:[{tx:'æ¥­å‹™æ™‚é–“å†…ã§ã‚„ã‚ã†',ef:'å…¨ã‚¹ã‚­ãƒ«+3ã€ãƒ¡ãƒ³ã‚¿ãƒ«+10',fn:function(){G.s.staff.forEach(function(s){Object.keys(s.stats).forEach(function(k){s.stats[k]=clamp(s.stats[k]+3,0,99);});s.mental=clamp(s.mental+10,0,100);});notify('å…¨ç¤¾å“¡ã‚¹ã‚­ãƒ«UPï¼ãƒ¡ãƒ³ã‚¿ãƒ«å›å¾©ï¼','ok');SFX.good();}}]},
  {id:'nft',ic:'ğŸ¨',ty:'warn',tt:'NFTæ¡ˆä»¶ã®ã‚ªãƒ•ã‚¡ãƒ¼',
   ds:'ã€Œå ±é…¬ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã§ãŠæ”¯æ‰•ã„ã—ã¾ã™ï¼æœªæ¥ã®ä¾¡å€¤ã«æœŸå¾…ã‚’ï¼ã€',
   ch:[{tx:'å—ã‘ã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ã§ï¼‰',ef:'åå…¥ã‚ã‚‹ãŒç‚ä¸Š+15',fn:function(){G.s.money+=150000;G.s.fire=clamp(G.s.fire+15,0,100);addLog('NFTæ¡ˆä»¶å—æ³¨ã€‚ãƒˆãƒ¼ã‚¯ãƒ³å—ã‘å–ã‚Šã€‚å°†æ¥ãŒå¿ƒé…ã€‚','warn');}},
       {tx:'ç¾é‡‘æ‰•ã„ãªã‚‰å—ã‘ã‚‹',ef:'æ™®é€šã®æ¡ˆä»¶ã¨ã—ã¦å—æ³¨',fn:function(){G.s.money+=200000;addLog('ç¾é‡‘æ‰•ã„äº¤æ¸‰æˆåŠŸã€‚','good');}},
       {tx:'æ–­ã‚‹ï¼ˆæ­£è§£ã®äºˆæ„Ÿï¼‰',ef:'å®‰å…¨ã€‚ç‚ä¸Šå›é¿',fn:function(){notify('NFTæ¡ˆä»¶ã‚’æ–­ã£ãŸã€‚æ­£è§£ã‹ã‚‚ã€‚','ok');}}]},
  {id:'ai_wave',ic:'ğŸ¤–',ty:'warn',tt:'AIã®æ³¢ãŒæ¥ãŸâ€¦',
   ds:'ã€ŒAIã§ãƒ‡ã‚¶ã‚¤ãƒ³ã§ãã‚‹ã‚‰ã—ã„ã§ã™ã­ã€‚å¾¡ç¤¾ã«é ¼ã‚€å¿…è¦ã‚ã‚Šã¾ã™ã‹ï¼Ÿã€',
   ch:[{tx:'AIã‚’ç©æ¥µæ´»ç”¨ã™ã‚‹æˆ¦ç•¥ã¸',ef:'AIæ´»ç”¨æŠ€è¡“è§£æ”¾',fn:function(){G.s.tech['ai_design']=true;notify('AIæ´»ç”¨ã‚¹ã‚¿ã‚¸ã‚ªã¨ã—ã¦é€²åŒ–å®£è¨€ï¼','ok');addLog('AIæ´»ç”¨æ–¹é‡ã‚’ç™ºè¡¨ã€‚','good');}},
       {tx:'äººé–“ã®ä¾¡å€¤ã‚’ä¸å¯§ã«èª¬æ˜ã™ã‚‹',ef:'è©•åˆ¤+5',fn:function(){G.s.rep=clamp(G.s.rep+5,0,100);addLog('äººé–“ãƒ‡ã‚¶ã‚¤ãƒ³ã®ä¾¡å€¤ã‚’èª¬æ˜ã€‚å…±æ„Ÿã‚’å¾—ãŸã€‚','good');}}]},
  {id:'overtime',ic:'ğŸ˜«',ty:'warn',tt:'æ®‹æ¥­ãŒç¶šã„ã¦ã„ã‚‹â€¦',
   ds:'ç· ã‚åˆ‡ã‚ŠãŒé‡ãªã‚Šã€ç¤¾å“¡ã®æ®‹æ¥­ãŒ3é€±é–“ç¶šã„ã¦ã„ã¾ã™ã€‚',
   ch:[{tx:'æ®‹æ¥­åˆ¶é™ã‚’è¨­ã‘ã‚‹',ef:'ãƒ–ãƒ©ãƒƒã‚¯-20ã€ãƒ¡ãƒ³ã‚¿ãƒ«+10',fn:function(){G.s.black=clamp(G.s.black-20,0,100);G.s.staff.forEach(function(s){s.mental=clamp(s.mental+10,0,100);});addLog('æ®‹æ¥­åˆ¶é™è¨­å®šã€‚ãƒ–ãƒ©ãƒƒã‚¯åº¦ä½ä¸‹ã€‚','good');}},
       {tx:'æ®‹æ¥­ä»£ã‚’å‡ºã—ã¦ç¶™ç¶š',ef:'-30ä¸‡å††ã€ç¤¾å“¡ã¯ç–²å¼Š',fn:function(){G.s.money-=300000;addLog('æ®‹æ¥­ä»£ã‚’æ”¯æ‰•ã£ã¦ç¶™ç¶šã€‚ç¤¾å“¡ã¯ç–²å¼Šã€‚','bad');}}]},
  {id:'birthday',ic:'ğŸ‚',ty:'success',tt:'ç¤¾å“¡ã®èª•ç”Ÿæ—¥ï¼',
   ds:'ä»Šæ—¥ã¯å¤§åˆ‡ãªç¤¾å“¡ã®èª•ç”Ÿæ—¥ã§ã™ã€‚',
   ch:[{tx:'ã‚µãƒ—ãƒ©ã‚¤ã‚ºãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼',ef:'å…¨ãƒ¡ãƒ³ã‚¿ãƒ«+15',fn:function(){G.s.staff.forEach(function(s){s.mental=clamp(s.mental+15,0,100);});notify('ã‚µãƒ—ãƒ©ã‚¤ã‚ºæˆåŠŸï¼å…¨å“¡ãƒãƒƒãƒ”ãƒ¼ï¼','ok');SFX.coin();}}]},
  {id:'big_deal',ic:'ğŸ¯',ty:'success',tt:'å¤§å‹æ¡ˆä»¶ã®ç›´æ¥ã‚ªãƒ•ã‚¡ãƒ¼ï¼',
   ds:'æ¥­ç•Œã®æœ‰åä¼æ¥­ã‹ã‚‰ç›´æ¥æŒ‡åã§ã‚ªãƒ•ã‚¡ãƒ¼ãŒå±Šãã¾ã—ãŸã€‚',
   ch:[{tx:'å—ã‘ã‚‹ï¼',ef:'+200ã€œ500ä¸‡å††',fn:function(){var e=2000000+ri(0,3000000);G.s.money+=e;G.s.rep=clamp(G.s.rep+10,0,100);addLog('å¤§å‹ç›´æ¥æ¡ˆä»¶ï¼'+fY(e)+'ï¼','good');SFX.fanfare();}},
       {tx:'ã‚­ãƒ£ãƒ‘ãŒå¿ƒé…ãªã®ã§æ–­ã‚‹',ef:'è©•åˆ¤-2',fn:function(){G.s.rep=clamp(G.s.rep-2,0,100);addLog('å¤§å‹æ¡ˆä»¶ã‚’æ–­ã£ãŸã€‚','');}}]},
  {id:'veteran',ic:'ğŸ‘´',ty:'success',tt:'æ¥­ç•Œã®é‡é®ã‹ã‚‰ã‚¢ãƒ‰ãƒã‚¤ã‚¹',
   ds:'è‘—åãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã‹ã‚‰ç›´æ¥ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã‚‚ã‚‰ãˆã‚‹æ©Ÿä¼šãŒè¨ªã‚Œã¾ã—ãŸã€‚',
   ch:[{tx:'å…¨ç¤¾å“¡ã§è©±ã‚’èã',ef:'å…¨ã‚¹ã‚­ãƒ«+5ã€è©•åˆ¤+8',fn:function(){G.s.staff.forEach(function(s){Object.keys(s.stats).forEach(function(k){s.stats[k]=clamp(s.stats[k]+5,0,99);});});G.s.rep=clamp(G.s.rep+8,0,100);addLog('é‡é®ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã§å…¨å“¡æˆé•·ï¼','good');SFX.good();}}]},
  {id:'note_viral',ic:'âœï¸',ty:'success',tt:'ç¤¾å“¡ã®noteãŒãƒã‚ºã£ãŸï¼',
   ds:'ç¤¾å“¡ãŒæ›¸ã„ãŸãƒ‡ã‚¶ã‚¤ãƒ³è«–ã®noteãŒãƒ“ã‚¸ãƒã‚¹ç•Œéšˆã§ãƒã‚ºã£ã¦ã„ã¾ã™ã€‚',
   ch:[{tx:'ç©æ¥µçš„ã«ã‚·ã‚§ã‚¢',ef:'SNS+600ã€æ¡ç”¨å•ã„åˆã‚ã›æ€¥å¢—',fn:function(){G.s.sns+=600;G.s.rep=clamp(G.s.rep+12,0,100);addLog('noteè¨˜äº‹ãƒã‚ºï¼æ¡ç”¨å•ã„åˆã‚ã›æ€¥å¢—ï¼','good');SFX.good();}},
       {tx:'é™ã‹ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—',ef:'SNS+200',fn:function(){G.s.sns+=200;G.s.rep=clamp(G.s.rep+5,0,100);addLog('noteè¨˜äº‹ã§èªçŸ¥åº¦UPã€‚','good');}}]},
  {id:'cash_crunch',ic:'ğŸ’¸',ty:'danger',tt:'è³‡é‡‘ã‚·ãƒ§ãƒ¼ãƒˆå¯¸å‰ï¼',
   ds:'å…¥é‡‘é…å»¶ãŒé‡ãªã‚Šã€å£åº§æ®‹é«˜ãŒå±é™ºåŸŸã«é”ã—ã¾ã—ãŸã€‚',
   ch:[{tx:'ç·Šæ€¥ã§å®‰ã„æ¡ˆä»¶ã‚’å—ã‘ã‚‹',ef:'+10ã€œ20ä¸‡å††',fn:function(){var e=100000+ri(0,100000);G.s.money+=e;addLog('ç·Šæ€¥æ¡ˆä»¶ã§'+fY(e)+'ã‚’ç¢ºä¿','good');}},
       {tx:'éŠ€è¡Œã«èè³‡ã‚’ç›¸è«‡ã™ã‚‹',ef:'+100ä¸‡å††ï¼ˆå€Ÿå…¥ï¼‰',fn:function(){G.s.money+=1000000;G.s.black=clamp(G.s.black+5,0,100);addLog('éŠ€è¡Œèè³‡100ä¸‡å††ç¢ºä¿ã€‚è¿”æ¸ˆãŒå¿…è¦ã€‚','warn');}}]},
];
var TECHS=[
  {row:'åŸºç¤æŠ€è¡“',nodes:[
    {id:'figma_basic',  nm:'FigmaåŸºç¤',      ic:'ğŸ¨',cost:0,      req:[],                      ef:'+å“è³ª5%',  desc:'åŸºæœ¬ãƒ„ãƒ¼ãƒ«ï¼ˆç¿’å¾—æ¸ˆã¿ï¼‰'},
    {id:'design_system',nm:'ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ',ic:'ğŸ§©',cost:300000, req:['figma_basic'],          ef:'+å“è³ª10%', desc:'ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç®¡ç†ã§å“è³ªå®‰å®š'},
    {id:'ux_research',  nm:'UXãƒªã‚µãƒ¼ãƒ',      ic:'ğŸ”¬',cost:200000, req:['figma_basic'],          ef:'+UIå“è³ª15%',desc:'UXãƒ»IAè¨­è¨ˆã‚’ç¿’å¾—'},
  ]},
  {row:'å¿œç”¨æŠ€è¡“',nodes:[
    {id:'motion',       nm:'ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³',       ic:'ğŸ¬',cost:500000, req:['design_system'],       ef:'+è©•åˆ¤5',   desc:'AfterEffectsãƒ»Lottie'},
    {id:'branding',     nm:'ãƒ–ãƒ©ãƒ³ãƒ‰æˆ¦ç•¥',     ic:'ğŸ’',cost:800000, req:['design_system','ux_research'],ef:'å˜ä¾¡UP',desc:'ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ¡ˆä»¶è§£æ”¾'},
    {id:'three_d',      nm:'3Dãƒ‡ã‚¶ã‚¤ãƒ³',       ic:'ğŸŒ',cost:600000, req:['motion'],               ef:'+å·®åˆ¥åŒ–',  desc:'Splineãƒ»Blenderå¯¾å¿œ'},
  ]},
  {row:'ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆæŠ€è¡“',nodes:[
    {id:'ai_design',    nm:'AIãƒ‡ã‚¶ã‚¤ãƒ³',       ic:'ğŸ¤–',cost:1000000,req:['branding'],             ef:'AIæ¡ˆä»¶è§£æ”¾',desc:'ç”ŸæˆAIæ´»ç”¨ãƒ»AIãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè§£æ”¾'},
    {id:'global',       nm:'ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹',   ic:'ğŸŒ',cost:3000000,req:['branding','ai_design'], ef:'ä¸–ç•Œã‚¨ãƒ³ãƒ‰', desc:'æµ·å¤–ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ»ä¸–ç•Œã‚¨ãƒ³ãƒ‰è§£æ”¾'},
  ]},
];
var OFFICES=[
  {nm:'ã‚³ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°',  ic:'â˜•',  cost:0,        rp:0, mc:0,       desc:'2ç•³ã®ã‚¹ãƒšãƒ¼ã‚¹ã€‚å®¶è³ƒ0å††ã€‚ã§ã‚‚é›†ä¸­ã§ããªã„ã€‚'},
  {nm:'æ¸‹è°·ã‚ªãƒ•ã‚£ã‚¹',  ic:'ğŸ™ï¸',cost:2000000, rp:10,mc:300000,  desc:'æ¸‹è°·ã®å°ã•ãªã‚ªãƒ•ã‚£ã‚¹ã€‚æ¡ç”¨åŠ›UPã€‚å®¶è³ƒ30ä¸‡/æœˆã€‚'},
  {nm:'è¡¨å‚é“ã‚ªãƒ•ã‚£ã‚¹',ic:'ğŸŒ¿',  cost:8000000, rp:25,mc:800000,  desc:'æ´—ç·´ã•ã‚ŒãŸã‚ªãƒ•ã‚£ã‚¹ã€‚æ¡ˆä»¶å˜ä¾¡UPã€‚å®¶è³ƒ80ä¸‡/æœˆã€‚'},
  {nm:'ä¸–ç•Œé€²å‡º',      ic:'ğŸŒ',  cost:30000000,rp:60,mc:3000000, desc:'NYãƒ»LDNãƒ»TOKYOã«ã‚ªãƒ•ã‚£ã‚¹ã€‚ä¸–ç•Œã‚¨ãƒ³ãƒ‰ç¢ºå®šã€‚'},
];
var OFF_LB=['COWORKING SPACE','SHIBUYA OFFICE','OMOTESANDO OFFICE','GLOBAL STUDIO'];
var HIRE_POOL=[
  {nm:'ç”°ä¸­ ã•ãã‚‰',role:'UIãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼',  ic:'ğŸ¨',sal:350000,st:{design:72,speed:80,logic:65,ui:85,comm:60},mental:80,risk:'Xã§ãƒ‡ã‚¶ã‚¤ãƒ³è«–äº‰ã‚’ã‚ˆãã‚„ã‚‹',ph:0},
  {nm:'éˆ´æœ¨ ã‚†ã†ã',role:'ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯', ic:'âœï¸',sal:320000,st:{design:88,speed:55,logic:50,ui:60,comm:70},mental:75,risk:'UIã«ã¯è‹¦æ‰‹æ„è­˜ãŒã‚ã‚‹',ph:0},
  {nm:'å±±ç”° ã‚ãŠã„',role:'PM',            ic:'ğŸ“‹',sal:420000,st:{design:45,speed:70,logic:90,ui:55,comm:92},mental:85,risk:'ä¼šè­°ã‚’å¢—ã‚„ã™å‚¾å‘ãŒã‚ã‚‹',ph:0},
  {nm:'ä½è—¤ ã¯ãª',  role:'UX',            ic:'ğŸ”¬',sal:380000,st:{design:60,speed:60,logic:88,ui:75,comm:78},mental:80,risk:'ã€Œãã‚ŒUIã®è©±ã§ã¯ï¼Ÿã€ã¨è¨€ã„ãŒã¡',ph:0},
  {nm:'ä¼Šè—¤ ã‘ã‚“ãŸ',role:'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢',    ic:'ğŸ’»',sal:500000,st:{design:40,speed:92,logic:85,ui:65,comm:60},mental:70,risk:'ã€Œå®Ÿè£…ã§ããªã„ã‚“ã§ã™ã‘ã©ã€ã¨è¨€ã†',ph:1},
  {nm:'æ¸¡è¾º ã¿ãŠ',  role:'ã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ã‚¿ãƒ¼',ic:'âœï¸',sal:300000,st:{design:55,speed:65,logic:72,ui:50,comm:88},mental:82,risk:'è¨€èªåŒ–ã®è¦æ±‚ãƒ¬ãƒ™ãƒ«ãŒé«˜ã„',ph:0},
  {nm:'ä¸­æ‘ ã‚Šã‚‡ã†',role:'ãƒ¢ãƒ¼ã‚·ãƒ§ãƒŠãƒ¼',  ic:'ğŸ¬',sal:450000,st:{design:78,speed:60,logic:55,ui:70,comm:65},mental:78,risk:'ã€Œå‹•ãã§è§£æ±ºã€æ€è€ƒã§è²»ç”¨ãŒã‹ã‹ã‚‹',ph:1},
  {nm:'å°æ— ãªã¤ã¿',role:'ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯', ic:'ğŸ–Œï¸',sal:280000,st:{design:65,speed:70,logic:60,ui:55,comm:55},mental:65,risk:'ã‚»ãƒ³ã‚¹ãŒæ¡ç”¨å¾Œã«åˆ¤æ˜ã™ã‚‹ã‚¿ã‚¤ãƒ—',ph:0},
  {nm:'åŠ è—¤ ã—ã‚“ã‚„',role:'AIãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼', ic:'ğŸ¤–',sal:600000,st:{design:60,speed:95,logic:80,ui:75,comm:65},mental:75,risk:'ã€ŒAIã£ã½ã„ã€ã¨è¨€ã‚ã‚Œã‚„ã™ã„',ph:2},
  {nm:'å‰ç”° ãˆã¿',  role:'UIãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼', ic:'ğŸ¨',sal:400000,st:{design:80,speed:75,logic:70,ui:92,comm:72},mental:78,risk:'å‰ã®ä¼šç¤¾ã®æ„šç—´ã‚’è¨€ã„ãŒã¡',ph:0},
  {nm:'æ¾æœ¬ ãã‚‰',  role:'UX',            ic:'ğŸ”',sal:440000,st:{design:65,speed:62,logic:91,ui:80,comm:82},mental:83,risk:'ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼ã‚’å¤šç”¨ã™ã‚‹',ph:1},
  {nm:'äº•ä¸Š ãŸã‘ã‚‹',role:'ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢',    ic:'âš™ï¸',sal:550000,st:{design:35,speed:88,logic:90,ui:70,comm:68},mental:72,risk:'ãƒ‡ã‚¶ã‚¤ãƒ³ã‚ˆã‚Šå®Ÿè£…ã‚’å„ªå…ˆã™ã‚‹',ph:1},
  {nm:'æœ¨æ‘ ã‚†ãª',  role:'PM',            ic:'ğŸ“Š',sal:480000,st:{design:42,speed:75,logic:88,ui:60,comm:90},mental:88,risk:'ãƒ—ãƒ­ã‚»ã‚¹ã‚’é‡è¦–ã—ã™ãã‚‹',ph:2},
  {nm:'æ— ã¾ã•ã¨',  role:'ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯', ic:'ğŸ¨',sal:360000,st:{design:91,speed:50,logic:48,ui:55,comm:72},mental:70,risk:'å®Œç’§ä¸»ç¾©ã§ç´æœŸãŒå±ãªã„ã“ã¨ãŒã‚ã‚‹',ph:1},
  {nm:'é«˜æ©‹ ã‚Šãª',  role:'UIãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼', ic:'ğŸ¨',sal:380000,st:{design:76,speed:72,logic:68,ui:88,comm:75},mental:82,risk:'ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã«ã“ã ã‚ã‚Šã™ãã‚‹',ph:0},
  {nm:'è¿‘è—¤ ã¾ã‚„',  role:'ã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ã‚¿ãƒ¼',ic:'ğŸ“',sal:320000,st:{design:52,speed:68,logic:75,ui:48,comm:92},mental:85,risk:'è¨€è‘‰ã®åŠ›ã‚’ä¿¡ã˜ã™ãã¦ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚’è»½è¦–',ph:0},
];
var ENDINGS=[
  {id:'world', tt:'ğŸŒ ä¸–ç•Œçš„ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¹ã‚¿ã‚¸ã‚ª',col:'var(--gold)',
   cond:function(s){return s.rep>=90&&s.awards>=3&&s.tech['global'];},
   story:'ADCã‚°ãƒ©ãƒ³ãƒ—ãƒªå—è³ã€‚NYã€LDNã€TOKYOã«ã‚ªãƒ•ã‚£ã‚¹ã‚’æ§‹ãˆãŸã€‚\nä¸–ç•Œä¸­ã®ãƒ–ãƒ©ãƒ³ãƒ‰ãŒã€Œã‚ãªãŸã®ä¼šç¤¾ã«é ¼ã¿ãŸã„ã€ã¨è¨€ã£ã¦ãã‚Œã‚‹ã€‚\næœ€åˆã®2ç•³ã®ã‚³ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¹ãƒšãƒ¼ã‚¹ãŒã€é ã„æ˜”ã®ã‚ˆã†ã«æ„Ÿã˜ã‚‰ã‚Œã‚‹ã€‚\n\nã™ã¹ã¦ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã«è¾¼ã‚ãŸæ„›ã¯ã€ã¡ã‚ƒã‚“ã¨ä¸–ç•Œã«å±Šã„ã¦ã„ãŸã€‚'},
  {id:'product',tt:'ğŸš€ ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆä¼æ¥­ã¸ã®è»¢èº«',col:'var(--teal)',
   cond:function(s){return s.tech['ai_design']&&s.projDone>=30&&s.totalRev>=50000000;},
   story:'ã€Œå…ƒãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾ã€ã¨ã—ã¦æ¥­ç•Œã«èªã‚Šç¶™ãŒã‚Œã‚‹ã“ã¨ã«ãªã‚‹ã€‚\nè‡ªç¤¾ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®DAUãŒ10ä¸‡ã‚’è¶…ãˆãŸã€‚\nãƒ‡ã‚¶ã‚¤ãƒ³ã®åŠ›ã§ã€ä¸–ç•Œã®ä½¿ã„æ–¹ã‚’å¤‰ãˆã‚‹ã“ã¨ãŒã§ããŸã€‚'},
  {id:'god',   tt:'âœ¨ ç¥ã‚¹ã‚¿ã‚¸ã‚ªï¼ˆBest Endingï¼‰',col:'var(--acc2)',
   cond:function(s){return s.staff.length>=5&&s.staff.every(function(x){return x.mental>=70;})&&s.rep>=75;},
   story:'å°ã•ã„ã‘ã‚Œã©ã€æœ€é«˜ã®ä¼šç¤¾ã€‚\nç¤¾å“¡å…¨å“¡ã®ãƒ¡ãƒ³ã‚¿ãƒ«ãŒé«˜ãã€ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚‚è©•åˆ¤ã‚‚ç”³ã—åˆ†ãªã„ã€‚\nã€Œè¦æ¨¡ã˜ã‚ƒãªã„ã€æ„›ã ã€ã¨ã„ã†çµè«–ã«è‡³ã£ãŸã€‚\n\nèª°ã‚‚ãŒç¾¨ã‚€ã€æœ¬ç‰©ã®ã‚¹ã‚¿ã‚¸ã‚ªã€‚\nç¤¾å“¡å…¨å“¡ãŒã€Œã“ã“ã§åƒã‘ã¦ã‚ˆã‹ã£ãŸã€ã¨è¨€ã£ã¦ãã‚ŒãŸã€‚'},
  {id:'ipo',   tt:'ğŸ“ˆ ä¸Šå ´ï¼',col:'var(--gold)',
   cond:function(s){return s.totalRev>=100000000&&s.fire<=20&&s.staff.length>=20;},
   story:'æ ªå¼ä¸Šå ´ã‚’æœãŸã—ãŸã€‚\nCFOæ¡ç”¨ãƒ»IRè³‡æ–™ä½œæˆãƒ»æŠ•è³‡å®¶èª¬æ˜ä¼šã€‚\nã€Œãƒ‡ã‚¶ã‚¤ãƒ³ã‚ˆã‚ŠIRè³‡æ–™ã®æ–¹ãŒå¿™ã—ã„ã€ã¨ã„ã†\næƒ³å®šå¤–ã®æ—¥å¸¸ãŒå¾…ã£ã¦ã„ãŸã€‚\n\nãã‚Œã§ã‚‚ã€ä¼šç¤¾ã¯å¤§ãããªã£ãŸã€‚'},
  {id:'fire',  tt:'ğŸ”¥ ç‚ä¸Šè§£æ•£â€¦',col:'var(--red)',
   cond:function(s){return s.fire>=90;},
   story:'ç‚ä¸Šãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒé™ç•Œã‚’è¶…ãˆãŸã€‚\nç¤¾é•·ã®Xãƒã‚¹ãƒˆãŒç™ºç«¯ã§æ¥­ç•Œå…¨ä½“ã‚’æ•µã«å›ã—ãŸã€‚\n\nã€Œã‚ã®æ™‚ä»£ã®åé¢æ•™å¸«ã€ã¨ã—ã¦ã€æ¥­ç•Œã«è²¢çŒ®ã™ã‚‹ã“ã¨ãŒã§ããŸã€‚\nã‚ã‚‹æ„å‘³ã€ã“ã‚Œã‚‚ä¸€ã¤ã®ãƒ¬ã‚¬ã‚·ãƒ¼ã€‚'},
  {id:'nft',   tt:'ğŸ¨ NFTã§ç ´æ»…',col:'#e040fb',
   cond:function(s){return s.fire>=60&&s.money<=0;},
   story:'å—ã‘å–ã£ãŸãƒˆãƒ¼ã‚¯ãƒ³ãŒå…¨éƒ¨ç´™ããšã«ãªã£ãŸã€‚\nã€Œä¿¡ã˜ã¦ãŸã®ã«ã€ã¨ã„ã†ãƒ†ãƒ­ãƒƒãƒ—ãŒæµã‚Œç¶šã‘ã‚‹ã€‚\n\næ¬¡ã®ãƒãƒ–ãƒ«ã«ã¯ä¹—ã‚‰ãªã„ã¨èª“ã£ãŸã€‚\nã§ã‚‚ã€ã¾ãŸä¹—ã£ã¦ã—ã¾ã†ã‹ã‚‚ã—ã‚Œãªã„ã€‚ãã‚ŒãŒäººé–“ã ã‹ã‚‰ã€‚'},
  {id:'broke', tt:'ğŸ’¸ è³‡é‡‘ã‚·ãƒ§ãƒ¼ãƒˆå€’ç”£',col:'var(--red)',
   cond:function(s){return s.money<=-1000000;},
   story:'å£åº§ãŒãƒã‚¤ãƒŠã‚¹ã«ãªã£ãŸã€‚\nã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼ã¯ãƒ‡ã‚¶ã‚¤ãƒ³ã‚ˆã‚Šé‡è¦ã¨ã„ã†\næ®‹é…·ãªçœŸå®Ÿã‚’çŸ¥ã£ãŸã€‚\n\næ¬¡ã¯çµŒå–¶ã‚’å­¦ã‚“ã§ã‹ã‚‰å§‹ã‚ã‚ˆã†ã€‚'},
];

// â”€â”€â”€ STATE & LOG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var gLog=[];
function addLog(txt,type){gLog.unshift({t:txt,ty:type||'',w:G.s.turn});if(gLog.length>60)gLog.pop();renderLog();}
function renderLog(){var el=q('glog');if(!el)return;var h='';gLog.slice(0,30).forEach(function(l){h+='<div class="le '+l.ty+'"><span class="le-t">T'+l.w+'â–¶</span><span class="le-x">'+esc(l.t)+'</span></div>';});el.innerHTML=h;}
function fireRandom(){var ns=G.s.staff.filter(function(s){return!s.isSelf;});if(!ns.length)return;var s=pick(ns);G.s.actives.forEach(function(p){if(p.asgn===s.id)p.asgn=null;});G.s.staff=G.s.staff.filter(function(x){return x.id!==s.id;});G.s.rep=clamp(G.s.rep-3,0,100);addLog(s.nm+'ãŒé€€è·ã—ãŸã€‚','bad');notify(s.nm+'ãŒé€€è·ã—ã¦ã—ã¾ã„ã¾ã—ãŸâ€¦','danger');SFX.bad();}

// â”€â”€â”€ MAIN GAME OBJECT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var G={
  s:{},
  busy:false,
  curTab:'dash',
  ocId:null,tcId:null,
  revCb:null,

  initState:function(){
    G.s={
      turn:1,money:38000,rep:12,fire:0,sns:84,black:5,
      phase:0,offLevel:0,compName:'å€‹äººäº‹å‹™æ‰€',
      tech:{figma_basic:true},
      totalRev:0,totalProj:0,projDone:0,totalMods:0,awards:0,
      staff:[],actives:[],avail:[],hirePool:[],monthNum:0,oAnim:0
    };
    G.staffPos=[];
    G.autoPlay=true;
    G.autoSpeed=2500;
    G.autoTimer=null;
  },

  toggleAuto:function(){
    G.autoPlay=!G.autoPlay;
    var btn=q('btn-auto');
    if(G.autoPlay){
      btn.textContent='â–¶ AUTO';btn.classList.add('on');
      notify('è‡ªå‹•é€²è¡ŒONï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã§åœæ­¢ï¼‰','ok',2000);
      G.scheduleAuto();
    } else {
      btn.textContent='â¸ AUTO';btn.classList.remove('on');
      if(G.autoTimer){clearTimeout(G.autoTimer);G.autoTimer=null;}
      notify('è‡ªå‹•é€²è¡ŒOFF','warn',1500);
    }
  },

  setAutoSpeed:function(v){G.autoSpeed=parseInt(v);},

  scheduleAuto:function(){
    if(!G.autoPlay)return;
    if(G.autoTimer)clearTimeout(G.autoTimer);
    G.autoTimer=setTimeout(function(){
      if(!G.autoPlay||G.busy)return G.scheduleAuto();
      var anyModal=q('modal-ev').classList.contains('open')||q('modal-mod').classList.contains('open')||q('modal-rev').classList.contains('open');
      if(anyModal){G.scheduleAuto();return;}
      G.nextTurn();
    },G.autoSpeed);
  },

  mkSelf:function(){return{id:'self',nm:'ã‚ãªãŸ',role:'UIãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼',ic:'ğŸ§‘â€ğŸ’»',sal:0,stats:{design:65,speed:70,logic:60,ui:72,comm:65},mental:90,status:'idle',isSelf:true,sense:70};},

  genProjects:function(){
    var avail=PTYPES.filter(function(p){return p.ph<=G.s.phase;});
    var cnt=3+G.s.phase;G.s.avail=[];
    for(var i=0;i<cnt;i++){
      var pt=pick(avail),ct=pick(CTYPES);
      var nm=pick(PNAMES[pt.id]||[pt.lb+'æ¡ˆä»¶']);
      var pm=0.75+Math.random()*0.55,diff=clamp(1+Math.floor(Math.random()*3+G.s.phase*0.6),1,5);
      var tb=G.s.tech['design_system']?1.1:1;
      G.s.avail.push({id:'p'+Date.now()+i,tid:pt.id,tlb:pt.lb,tic:pt.ic,tcss:pt.css,nm:nm,cli:ct,
        price:Math.round(pt.base*pm*(1+G.s.phase*0.4)*ct.pm*tb),days:pt.days+ri(0,3),
        diff:diff,dead:ri(3,8),urg:Math.random()>0.75,sk:pt.sk,prog:0,asgn:null,modCnt:0});
    }
  },

  genHire:function(){
    var pool=HIRE_POOL.filter(function(h){
      if(h.ph>G.s.phase)return false;
      if(h.role==='AIãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼'&&!G.s.tech['ai_design'])return false;
      if(G.s.staff.some(function(s){return s.nm===h.nm;}))return false;
      return true;
    });
    G.s.hirePool=shuffle(pool).slice(0,4+G.s.phase*2);
  },

  // â”€ CANVAS: OFFICE â”€
  startOC:function(){
    var cv=q('ocv');if(!cv)return;
    cv.width=cv.parentElement.clientWidth;cv.height=240;
    if(G.ocId)cancelAnimationFrame(G.ocId);
    (function loop(){G.drawOC(cv);G.ocId=requestAnimationFrame(loop);})();
  },

  drawOC:function(cv){
    var ctx=cv.getContext('2d'), W=cv.width, H=cv.height;
    G.s.oAnim=(G.s.oAnim||0)+1;
    var t=G.s.oAnim, lv=G.s.offLevel;

    // â”â” PIXEL SCALE â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    var PX=2; // ãƒ”ã‚¯ã‚»ãƒ«ã‚µã‚¤ã‚ºï¼ˆ2å€æ‹¡å¤§ã§ãƒ‰ãƒƒãƒˆæ„ŸUPï¼‰

    function px(x,y,w,h,col){ ctx.fillStyle=col; ctx.fillRect(x*PX,y*PX,w*PX,h*PX); }
    function line(x1,y1,x2,y2,col,wd){
      ctx.strokeStyle=col; ctx.lineWidth=(wd||1)*PX;
      ctx.beginPath(); ctx.moveTo(x1*PX,y1*PX); ctx.lineTo(x2*PX,y2*PX); ctx.stroke();
    }

    var CW=Math.floor(W/PX), CH=Math.floor(H/PX); // ã‚­ãƒ£ãƒ³ãƒã‚¹ã®è«–ç†ã‚µã‚¤ã‚º

    // â”â” FLOOR â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // Gatherãƒ©ã‚¤ã‚¯ãªæ˜ã‚‹ã„ã‚°ãƒ¬ãƒ¼åºŠ
    var floorBase=[
      ['#c8ccd0','#bec2c6'],  // ã‚³ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ï¼ˆãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼ï¼‰
      ['#d0d4d8','#c6cacd'],  // æ¸‹è°·ï¼ˆå°‘ã—æ˜ã‚‹ãï¼‰
      ['#d4d8dc','#cacdd1'],  // è¡¨å‚é“ï¼ˆã•ã‚‰ã«æ˜ã‚‹ãï¼‰
      ['#d8dce0','#ced2d6'],  // ã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼ˆæœ€æ˜ï¼‰
    ];
    var fb=floorBase[lv];
    var TILE=8;
    for(var ty=0;ty<CH;ty+=TILE){
      for(var tx=0;tx<CW;tx+=TILE){
        var f2=(((tx/TILE)+(ty/TILE))%2===0);
        ctx.fillStyle=f2?fb[0]:fb[1];
        ctx.fillRect(tx*PX,ty*PX,TILE*PX,TILE*PX);
      }
    }

    // â”â” WALL (top strip) â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // Gatherã¯ä¸Šéƒ¨ã«å£ãŒã‚ã‚‹
    var wallH=12;
    var wallCols=['#b8a898','#c8b8a8','#d8c8b8','#e8d8c8'];
    px(0,0,CW,wallH,wallCols[lv]);
    // å£ã®ä¸‹ã®ã‚·ãƒ£ãƒ‰ã‚¦
    px(0,wallH,CW,2,'rgba(0,0,0,0.15)');
    // å£ã®çª“ï¼ˆlv>=1ï¼‰
    if(lv>=1){
      var winNum=Math.min(2+lv,4);
      for(var wi=0;wi<winNum;wi++){
        var wx=Math.floor(CW/(winNum+1))*(wi+1)-6;
        px(wx,1,12,9,'#88b8e0');  // çª“ã‚¬ãƒ©ã‚¹ï¼ˆç©ºã®é’ï¼‰
        px(wx,1,12,1,'rgba(255,255,255,0.5)');  // å…‰ã®åå°„
        px(wx,1,1,9,'rgba(255,255,255,0.3)');
        px(wx,0,12,1,'#998877');  // çª“æ 
        px(wx,10,12,1,'#998877');
        px(wx,0,1,11,'#998877');
        px(wx+11,0,1,11,'#998877');
      }
    }
    // å·¦å³ã®å£
    px(0,0,3,CH,'#a09080');
    px(CW-3,0,3,CH,'#a09080');

    // â”â” DESK DRAW FUNCTION (Gatheré¢¨ï¼šä¸Šé¢ä¿¯ç°) â”â”â”â”â”â”â”â”â”â”â”â”â”
    function drawDesk(dx,dy,staffIdx){
      var DW=22, DH=12;
      var hasStaff=(staffIdx>=0&&staffIdx<G.s.staff.length);
      var s2=hasStaff?G.s.staff[staffIdx]:null;

      // ãƒ‡ã‚¹ã‚¯å¤©æ¿ï¼ˆä¸Šé¢ï¼šå°‘ã—å°å½¢ï¼‰
      ctx.fillStyle='#f0f0f0';
      ctx.beginPath();
      ctx.moveTo((dx-DW)*PX,(dy-2)*PX);
      ctx.lineTo((dx+DW)*PX,(dy-2)*PX);
      ctx.lineTo((dx+DW-1)*PX,(dy+DH)*PX);
      ctx.lineTo((dx-DW+1)*PX,(dy+DH)*PX);
      ctx.closePath(); ctx.fill();
      // ãƒ‡ã‚¹ã‚¯ã®ç¸ï¼ˆç«‹ä½“æ„Ÿã®ã‚ã‚‹å½±ï¼‰
      ctx.fillStyle='#c0c4c8';
      ctx.beginPath();
      ctx.moveTo((dx-DW+1)*PX,(dy+DH)*PX);
      ctx.lineTo((dx+DW-1)*PX,(dy+DH)*PX);
      ctx.lineTo((dx+DW-1)*PX,(dy+DH+2)*PX);
      ctx.lineTo((dx-DW+1)*PX,(dy+DH+2)*PX);
      ctx.closePath(); ctx.fill();
      // ãƒ‡ã‚¹ã‚¯å·¦é¢
      ctx.fillStyle='#d0d4d8';
      ctx.fillRect((dx-DW)*PX,(dy-2)*PX,2*PX,(DH+2)*PX);

      // â”€â”€ ãƒ¢ãƒ‹ã‚¿ãƒ¼ â”€â”€
      var mc=hasStaff&&s2.status==='working'?
        [[90,120,220],[60,180,120],[200,80,140]][staffIdx%3]:[80,80,90];
      // ãƒ¢ãƒ‹ã‚¿ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ 
      ctx.fillStyle='#303030';
      ctx.fillRect((dx-10)*PX,(dy-16)*PX,20*PX,12*PX);
      // ãƒ¢ãƒ‹ã‚¿ãƒ¼ç”»é¢
      ctx.fillStyle='rgb('+mc[0]+','+mc[1]+','+mc[2]+')';
      ctx.fillRect((dx-9)*PX,(dy-15)*PX,18*PX,10*PX);
      // ç”»é¢ã‚°ãƒ­ãƒ¼ï¼ˆä½œæ¥­ä¸­ã®ã¿ï¼‰
      if(hasStaff&&s2.status==='working'){
        ctx.shadowColor='rgb('+mc[0]+','+mc[1]+','+mc[2]+')';
        ctx.shadowBlur=8*PX;
        ctx.fillStyle='rgba('+mc[0]+','+mc[1]+','+mc[2]+',0.3)';
        ctx.fillRect((dx-9)*PX,(dy-15)*PX,18*PX,10*PX);
        ctx.shadowBlur=0;
        // ç”»é¢ã®ã€Œã‚³ãƒ¼ãƒ‰ã€ãƒ©ã‚¤ãƒ³
        var li2=Math.floor(t*0.08)%4;
        for(var rw=0;rw<4;rw++){
          var rw2=rw===li2;
          ctx.fillStyle=rw2?'rgba(255,255,255,0.9)':'rgba(255,255,255,0.35)';
          ctx.fillRect((dx-8+rw)*PX,(dy-14+rw*2)*PX,(10-rw*1.5)*PX,1*PX);
        }
      } else {
        // ã‚¹ã‚¿ãƒ³ãƒã‚¤
        ctx.fillStyle='rgba(255,255,255,0.15)';
        ctx.fillRect((dx-9)*PX,(dy-15)*PX,18*PX,10*PX);
      }
      // ãƒ¢ãƒ‹ã‚¿ãƒ¼å°åº§
      ctx.fillStyle='#505050';
      ctx.fillRect((dx-2)*PX,(dy-4)*PX,4*PX,4*PX);
      ctx.fillRect((dx-4)*PX,(dy-1)*PX,8*PX,2*PX);

      // â”€â”€ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ â”€â”€
      ctx.fillStyle='#d8d8d8';
      ctx.fillRect((dx-8)*PX,(dy+2)*PX,16*PX,5*PX);
      ctx.fillStyle='#a0a0a0';
      for(var ki=0;ki<5;ki++){ctx.fillRect((dx-7+ki*3)*PX,(dy+3)*PX,2*PX,1*PX);}

      // â”€â”€ ãƒã‚¦ã‚¹ â”€â”€
      ctx.fillStyle='#d8d8d8';
      ctx.fillRect((dx+7)*PX,(dy+2)*PX,4*PX,5*PX);
      ctx.fillStyle='#c0c0c0';
      ctx.fillRect((dx+8)*PX,(dy+2)*PX,2*PX,2*PX);

      // â”€â”€ ã‚³ãƒ¼ãƒ’ãƒ¼ï¼ˆ50%ç¢ºç‡ï¼‰ â”€â”€
      if((staffIdx+lv)%2===0){
        ctx.fillStyle='#cc8844';
        ctx.fillRect((dx-DW+3)*PX,(dy+1)*PX,5*PX,5*PX);
        ctx.fillStyle='#553311';
        ctx.fillRect((dx-DW+4)*PX,(dy+2)*PX,3*PX,3*PX);
        // æ¹¯æ°—ã‚¢ãƒ‹ãƒ¡
        if(Math.sin(t*0.06+staffIdx)>0){
          ctx.fillStyle='rgba(200,200,220,0.5)';
          ctx.fillRect((dx-DW+5)*PX,(dy-2+Math.floor(Math.sin(t*0.1+staffIdx)*2))*PX,1*PX,3*PX);
        }
      }

      // â”€â”€ æ¤ç‰©ï¼ˆlv>=1ã®ä¸€éƒ¨ãƒ‡ã‚¹ã‚¯ï¼‰ â”€â”€
      if(lv>=1&&staffIdx%3===0){
        ctx.fillStyle='#885522';
        ctx.fillRect((dx+DW-6)*PX,(dy+1)*PX,4*PX,5*PX);
        ctx.fillStyle='#228822';
        ctx.fillRect((dx+DW-8)*PX,(dy-5)*PX,8*PX,8*PX);
        ctx.fillStyle='#44aa44';
        ctx.fillRect((dx+DW-7)*PX,(dy-7)*PX,5*PX,5*PX);
      }
    }

    // â”â” å¤§å‹æ¤ç‰© â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    function drawBigPlant(bx,by){
      px(bx-5,by,10,8,'#664422');
      px(bx-8,by-14,5,18,'#226622');
      px(bx+3,by-16,5,18,'#228833');
      px(bx-3,by-20,8,10,'#33aa33');
      px(bx-10,by-12,4,8,'rgba(40,160,40,0.7)');
      px(bx+6,by-10,4,8,'rgba(50,180,50,0.7)');
      // æºã‚Œ
      ctx.fillStyle='rgba(40,140,40,0.5)';
      ctx.fillRect((bx-6+Math.sin(t*0.025)*2)*PX,(by-18)*PX,3*PX,6*PX);
    }

    // â”â” ã‚½ãƒ•ã‚¡ï¼ˆGatheré¢¨ï¼šã‚ªãƒ¬ãƒ³ã‚¸ç³»ï¼‰ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    function drawSofa(sx,sy){
      // èƒŒã‚‚ãŸã‚Œ
      px(sx-20,sy,40,6,'#c86828');
      px(sx-20,sy,40,2,'#e08838');
      // åº§é¢
      px(sx-18,sy+6,36,10,'#d87830');
      px(sx-18,sy+6,36,2,'#e89840');
      // ã‚¢ãƒ¼ãƒ ãƒ¬ã‚¹ãƒˆ
      px(sx-22,sy,6,14,'#b85818');
      px(sx+16,sy,6,14,'#b85818');
      // å½±
      px(sx-18,sy+16,36,2,'rgba(0,0,0,0.2)');
      // ã‚¯ãƒƒã‚·ãƒ§ãƒ³
      px(sx-10,sy+7,9,7,'#c87028');
      px(sx+1,sy+7,9,7,'#c87028');
      px(sx-10,sy+7,9,1,'rgba(255,255,255,0.2)');
      px(sx+1,sy+7,9,1,'rgba(255,255,255,0.2)');
    }

    // â”â” ã‚³ãƒ¼ãƒ’ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ« â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    function drawTable(tx2,ty2){
      px(tx2-12,ty2,24,10,'#d4b896');
      px(tx2-12,ty2,24,1,'#e8ccaa');
      px(tx2-12,ty2+10,24,2,'#b09070');
    }

    // â”â” ã‚¹ã‚¿ãƒ³ãƒ‰ãƒ©ãƒ³ãƒ— â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    function drawLamp(lx,ly){
      px(lx,ly,2,20,'#888888');
      px(lx-5,ly-6,12,6,'#f0c040');
      px(lx-5,ly-6,12,1,'#fff8c0');
      if(Math.sin(t*0.03+lx)>0){
        ctx.fillStyle='rgba(240,192,64,0.15)';
        ctx.beginPath();
        ctx.arc((lx+1)*PX,(ly-3)*PX,18*PX,0,Math.PI*2);
        ctx.fill();
      }
    }

    // â”â” ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒ¼ãƒ‰ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    function drawBoard(bx2,by2){
      px(bx2-20,by2-28,40,30,'#f8f8f0');
      px(bx2-20,by2-28,40,1,'rgba(255,255,255,0.8)');
      px(bx2-20,by2+2,40,3,'#888888');
      // ãƒ•ãƒ¬ãƒ¼ãƒ 
      px(bx2-21,by2-29,1,32,'#666666');
      px(bx2+20,by2-29,1,32,'#666666');
      px(bx2-21,by2-29,42,1,'#666666');
      // æ›¸ã„ã¦ã‚ã‚‹å†…å®¹
      ctx.fillStyle='rgba(60,80,200,0.6)';
      ctx.font=(5*PX)+'px monospace';
      ctx.fillText('UI FLOW',(bx2-14)*PX,(by2-18)*PX);
      // çŸ¢å°ãƒ»å›³å½¢
      ctx.strokeStyle='rgba(200,60,60,0.6)';ctx.lineWidth=PX;
      ctx.beginPath();ctx.moveTo((bx2-12)*PX,(by2-8)*PX);ctx.lineTo((bx2-4)*PX,(by2-4)*PX);ctx.stroke();
      ctx.fillStyle='rgba(60,160,60,0.5)';
      ctx.fillRect((bx2+2)*PX,(by2-12)*PX,8*PX,6*PX);
    }

    // â”â” å†·è”µåº« â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    function drawFridge(fx,fy){
      px(fx-7,fy-20,14,28,'#dde0e4');
      px(fx-6,fy-19,12,12,'#f0f2f4');
      px(fx-6,fy-6,12,13,'#f0f2f4');
      px(fx-7,fy-20,14,1,'#b0b4b8');
      px(fx-7,fy-7,14,1,'#b0b4b8');
      px(fx+2,fy-14,2,3,'#888888');
      px(fx+2,fy-3,2,3,'#888888');
    }

    // â”â” LAYOUT: ãƒ‡ã‚¹ã‚¯é…ç½®ã‚’è¨ˆç®— â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    var deskRows=lv===0?1:lv===1?2:2;
    var deskCols=lv===0?1:lv===1?2:lv===2?3:4;
    var desks=[];
    var startY=wallH+18;
    var spaceY=(CH-startY-22)/(deskRows);
    for(var row=0;row<deskRows;row++){
      var dy2=startY+row*spaceY+spaceY*0.4;
      for(var col=0;col<deskCols;col++){
        var dx2=Math.floor(CW*(col+0.5+0.2)/(deskCols+0.4));
        desks.push({x:dx2,y:dy2,idx:row*deskCols+col});
      }
    }

    // â”â” STATIC OBJECTS â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    // è§’ã®å¤§å‹æ¤ç‰©ï¼ˆå¸¸ã«ï¼‰
    drawBigPlant(9, wallH+16);
    drawBigPlant(CW-9, wallH+16);

    // Lv1ä»¥ä¸Šï¼šãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒ¼ãƒ‰+ã‚½ãƒ•ã‚¡ã‚¨ãƒªã‚¢
    if(lv>=1){
      drawBoard(Math.floor(CW*0.5), wallH+4);
    }
    if(lv>=1){
      var sofaX=Math.floor(CW*0.75), sofaY=CH-22;
      drawSofa(sofaX, sofaY);
      drawTable(sofaX, sofaY+12);
      drawLamp(sofaX+25, sofaY-5);
    }
    if(lv>=2){
      drawFridge(10, CH-14);
      drawBigPlant(Math.floor(CW*0.3), CH-14);
      drawLamp(Math.floor(CW*0.5)-30, CH-8);
    }
    if(lv>=3){
      drawSofa(Math.floor(CW*0.25), CH-22);
      drawBigPlant(Math.floor(CW*0.6), CH-14);
    }

    // â”â” DESKS (ä¸‹â†’ä¸Šã®é †ã§æç”»ã§z-orderæ­£ã—ã) â”â”â”â”â”â”â”â”â”â”â”
    desks.slice().reverse().forEach(function(d){
      drawDesk(d.x, d.y, d.idx);
    });

    // â”â” STAFF CHARACTERS â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    if(!G.staffPos)G.staffPos=[];

    // ã‚¹ã‚¿ãƒƒãƒ•ä½ç½®ã®æ›´æ–°
    G.s.staff.forEach(function(s,i){
      var desk=desks[i]||desks[desks.length-1]||{x:CW/2,y:CH/2};
      if(!G.staffPos[i]){
        G.staffPos[i]={x:desk.x, y:desk.y+14, tx:desk.x, ty:desk.y+14, timer:0, state:'sit', flipTimer:0};
      }
      var sp=G.staffPos[i];
      sp.timer--;
      if(sp.timer<=0){
        var r2=Math.random();
        if(s.status==='working'||r2<0.62){
          // ãƒ‡ã‚¹ã‚¯ã«åº§ã‚‹
          sp.tx=desk.x+(Math.random()-0.5)*4;
          sp.ty=desk.y+14+(Math.random()-0.5)*3;
          sp.state='sit'; sp.timer=80+Math.floor(Math.random()*140);
        } else if(r2<0.78&&lv>=1&&desks.length>=2){
          // ä»–ã®ãƒ‡ã‚¹ã‚¯ã¸ç§»å‹•ï¼ˆç«‹ã£ã¦æ­©ãï¼‰
          var otherDesk=desks[Math.floor(Math.random()*desks.length)];
          sp.tx=otherDesk.x+(Math.random()-0.5)*6;
          sp.ty=otherDesk.y+14;
          sp.state='walk'; sp.timer=30+Math.floor(Math.random()*50);
        } else if(r2<0.88&&lv>=1){
          // ã‚½ãƒ•ã‚¡ã‚¨ãƒªã‚¢ã¸
          sp.tx=Math.floor(CW*0.7)+(Math.random()-0.5)*15;
          sp.ty=CH-18+(Math.random()-0.5)*5;
          sp.state='relax'; sp.timer=35+Math.floor(Math.random()*60);
        } else {
          // ã†ã‚ã†ã‚
          sp.tx=12+Math.random()*(CW-24);
          sp.ty=wallH+20+Math.random()*(CH-wallH-32);
          sp.state='walk'; sp.timer=20+Math.floor(Math.random()*35);
        }
      }
      // æ»‘ã‚‰ã‹ç§»å‹•
      sp.x+=(sp.tx-sp.x)*0.07;
      sp.y+=(sp.ty-sp.y)*0.07;
    });

    // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æç”»é–¢æ•°ï¼ˆGatheré¢¨ï¼šå¾Œã‚å‘ããƒ”ã‚¯ã‚»ãƒ«ã‚­ãƒ£ãƒ©ï¼‰
    var HAIR_COLS=['#3a2010','#c8b060','#102840','#501010','#282828','#8060a0','#204030'];
    var SKIN_COLS=['#f0c890','#d4a070','#a06840','#805028','#c09878'];
    var SHIRT_COLS=['#5060d0','#30a060','#c04060','#d0a020','#606080','#c06030','#40a0b0'];

    G.s.staff.forEach(function(s,i){
      var sp=G.staffPos[i]; if(!sp)return;
      var px2=sp.x, py2=sp.y;
      var tired=s.mental<30, busy=s.status==='working';

      // æ­©ããƒœãƒ–
      var bob=sp.state==='sit'?Math.sin(t*0.025+i*1.4)*0.4
             :sp.state==='walk'?Math.sin(t*0.18+i)*1.2
             :Math.sin(t*0.03+i)*0.3;

      // â” å½± â”
      ctx.fillStyle='rgba(0,0,0,0.18)';
      ctx.beginPath();
      ctx.ellipse(px2*PX,(py2+9)*PX,8*PX,2.5*PX,0,0,Math.PI*2);
      ctx.fill();

      ctx.save();
      ctx.translate(px2*PX,(py2+bob)*PX);

      // â” è¶³ï¼ˆæ­©ãã‚¢ãƒ‹ãƒ¡ï¼‰ â”
      var legSwing=sp.state==='walk'?Math.sin(t*0.22+i)*3:0;
      ctx.fillStyle=SKIN_COLS[i%5];
      ctx.fillRect((-3)*PX,(6+legSwing)*PX,3*PX,4*PX);  // å·¦è¶³
      ctx.fillRect((0)*PX,(6-legSwing)*PX,3*PX,4*PX);   // å³è¶³

      // â” ä½“ â”
      var shirtCol=tired?'#806060':SHIRT_COLS[i%7];
      ctx.fillStyle=shirtCol;
      ctx.fillRect(-4*PX,0*PX,8*PX,7*PX);
      // ä½“ã®å…‰
      ctx.fillStyle='rgba(255,255,255,0.12)';
      ctx.fillRect(-4*PX,0*PX,8*PX,2*PX);

      // â” é ­ â”
      ctx.fillStyle=SKIN_COLS[i%5];
      ctx.fillRect(-4*PX,-8*PX,8*PX,8*PX);
      // å¾Œã‚å‘ããªã®ã§è€³ã ã‘
      ctx.fillStyle=SKIN_COLS[(i+1)%5];
      ctx.fillRect(-5*PX,-5*PX,2*PX,3*PX);  // å·¦è€³
      ctx.fillRect(3*PX,-5*PX,2*PX,3*PX);   // å³è€³

      // â” é«ª â”
      ctx.fillStyle=HAIR_COLS[i%7];
      ctx.fillRect(-4*PX,-9*PX,8*PX,3*PX);  // å¾Œé ­éƒ¨ã®é«ª
      ctx.fillRect(-5*PX,-8*PX,2*PX,5*PX);  // å·¦ã‚µã‚¤ãƒ‰
      ctx.fillRect(3*PX,-8*PX,2*PX,5*PX);   // å³ã‚µã‚¤ãƒ‰

      // â” ãƒ˜ãƒƒãƒ‰ãƒ•ã‚©ãƒ³ï¼ˆä½œæ¥­ä¸­ï¼‰ â”
      if(busy){
        ctx.fillStyle='#202020';
        ctx.fillRect(-6*PX,-10*PX,2*PX,6*PX);  // å·¦ã‚¢ãƒ¼ãƒ 
        ctx.fillRect(4*PX,-10*PX,2*PX,6*PX);   // å³ã‚¢ãƒ¼ãƒ 
        ctx.fillRect(-6*PX,-11*PX,12*PX,2*PX); // ãƒãƒ³ãƒ‰
        ctx.fillStyle='#404040';
        ctx.fillRect(-7*PX,-7*PX,3*PX,4*PX);   // å·¦ã‚¤ãƒ¤ãƒ¼
        ctx.fillRect(4*PX,-7*PX,3*PX,4*PX);    // å³ã‚¤ãƒ¤ãƒ¼
      }

      // â” æ‰‹ãƒ»ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ï¼ˆãƒ‡ã‚¹ã‚¯ã«ã„ã‚‹æ™‚ï¼‰ â”
      if(sp.state==='sit'&&busy){
        var tkL=Math.sin(t*0.2+i)>0;
        ctx.fillStyle=SKIN_COLS[i%5];
        ctx.fillRect((-6)*PX,(3+(!tkL?1:0))*PX,3*PX,2*PX);
        ctx.fillRect((3)*PX,(3+(tkL?1:0))*PX,3*PX,2*PX);
      }

      // â” zzzï¼ˆç–²å¼Šæ™‚ï¼‰ â”
      if(tired){
        ctx.fillStyle='rgba(255,80,80,0.9)';
        ctx.font=(5*PX)+'px monospace';
        ctx.fillText('z',2*PX,-12*PX);
        if(Math.sin(t*0.04+i)>0){ctx.fillText('z',5*PX,-17*PX);}
      }

      ctx.restore();

      // â” åå‰ãƒãƒƒã‚¸ï¼ˆGatheré¢¨ï¼šé»’èƒŒæ™¯+åå‰ï¼‰ â”
      var nm2=s.nm.split(' ')[0];
      var badgeW=nm2.length*4+10;
      // ãƒãƒƒã‚¸èƒŒæ™¯
      ctx.fillStyle=busy?'rgba(20,20,50,0.88)':'rgba(20,20,30,0.75)';
      ctx.beginPath();
      var bx3=(px2-badgeW/2)*PX, by3=(py2+bob+11)*PX;
      ctx.roundRect(bx3,by3,badgeW*PX,9*PX,2*PX);
      ctx.fill();
      // åå‰ãƒ†ã‚­ã‚¹ãƒˆ
      ctx.fillStyle=busy?'#aaccff':'#ccccee';
      ctx.font=(5*PX)+'px monospace';
      ctx.fillText(nm2,(px2-badgeW/2+2)*PX,(py2+bob+18)*PX);
      // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ‰ãƒƒãƒˆ
      var dotC=tired?'#ff4040':busy?'#7c70f5':'#40cc70';
      ctx.fillStyle=dotC;
      ctx.beginPath();
      ctx.arc((px2+badgeW/2-4)*PX,(py2+bob+15)*PX,2*PX,0,Math.PI*2);
      ctx.fill();

      // â” ä½œæ¥­ä¸­ï¼šå¹ãå‡ºã— â”
      if(busy&&Math.sin(t*0.04+i*3.1)>0.65){
        var msgs=['â€¦','âœ“','!!','?!','ğŸ‘','OK'];
        var msg=msgs[(i+Math.floor(t*0.02))%msgs.length];
        ctx.fillStyle='rgba(255,255,255,0.92)';
        var bx4=(px2+3)*PX, by4=(py2+bob-20)*PX;
        ctx.beginPath();
        ctx.roundRect(bx4,by4,20*PX,10*PX,2*PX);
        ctx.fill();
        // å¹ãå‡ºã—ã®å°¾
        ctx.beginPath();
        ctx.moveTo(bx4+2*PX,by4+10*PX);
        ctx.lineTo(bx4,by4+14*PX);
        ctx.lineTo(bx4+6*PX,by4+10*PX);
        ctx.closePath(); ctx.fill();
        ctx.fillStyle='rgba(60,60,100,0.9)';
        ctx.font=(5*PX)+'px monospace';
        ctx.fillText(msg,bx4+2*PX,by4+8*PX);
      }
    });

    // â”â” PROGRESS BAR (bottom overlay) â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    var pr=G.s.actives.length>0?
      G.s.actives.reduce(function(a,p){return a+p.prog;},0)/G.s.actives.length:0;
    var tpEl=q('tp-bar'), ttEl=q('tp-txt');
    if(tpEl)tpEl.style.setProperty('--tp',Math.min(100,pr)+'%');
    if(ttEl){
      if(G.busy)ttEl.textContent='å‡¦ç†ä¸­...';
      else if(G.s.actives.length===0)ttEl.textContent='æ¡ˆä»¶ãªã— â”€ å—æ³¨ã—ã¦ãã ã•ã„';
      else ttEl.textContent='æ¡ˆä»¶é€²æ— '+Math.round(pr)+'%'+(G.autoPlay?' â–¶ AUTO':'ã€€â–¶â–¶ SPACE');
    }
  },

  startTC:function(){
    (function loop(){G.drawTC();G.tcId=requestAnimationFrame(loop);})();
  },
  drawTC:function(){
    var cv=q('tcv');if(!cv)return;
    var ctx=cv.getContext('2d'),W=cv.width,H=cv.height,t=Date.now()/1000;
    ctx.fillStyle='#f0efff';ctx.fillRect(0,0,W,H);
    for(var i=0;i<65;i++){var blink=Math.sin(t*0.5+i)*0.5+0.5;ctx.fillStyle='rgba(120,100,220,'+(blink*0.6)+')';ctx.fillRect((Math.sin(i*127.1)*0.5+0.5)*W,(Math.cos(i*311.7)*0.5+0.5)*H*0.65,1,1);}
    var blds=[{x:0,w:.08,y:.30},{x:.07,w:.06,y:.50},{x:.12,w:.11,y:.20},{x:.22,w:.07,y:.40},{x:.28,w:.13,y:.15},{x:.40,w:.08,y:.45},{x:.47,w:.14,y:.18},{x:.60,w:.09,y:.35},{x:.68,w:.11,y:.22},{x:.78,w:.07,y:.42},{x:.84,w:.10,y:.28},{x:.92,w:.08,y:.48}];
    blds.forEach(function(b){
      ctx.fillStyle='#d8d5f8';ctx.fillRect(b.x*W,b.y*H,b.w*W,(1-b.y)*H);
      var wc=Math.floor(b.w*W/9),wr=Math.floor((1-b.y)*H*0.55/11);
      var cols=[[124,112,245],[240,98,146],[69,212,168],[240,192,64]];
      for(var r=0;r<wr;r++)for(var c=0;c<wc;c++)if(Math.sin(t*0.3+b.x*10+r*3.8+c*2.2)>0.15){var cl=cols[(r+c)%4];ctx.fillStyle='rgba('+cl[0]+','+cl[1]+','+cl[2]+',.62)';ctx.fillRect(b.x*W+c*9+2,b.y*H+10+r*11,4,5);}
    });
    var gg=ctx.createLinearGradient(0,H*.83,0,H);gg.addColorStop(0,'rgba(124,112,245,0.1)');gg.addColorStop(1,'rgba(124,112,245,0.03)');ctx.fillStyle=gg;ctx.fillRect(0,H*.83,W,H*.17);
    ctx.fillStyle='#e8e6ff';ctx.fillRect(0,H*.84,W,H*.16);
    var ds=(t*20)%40;for(var rx=-40+ds;rx<W;rx+=40){ctx.fillStyle='rgba(240,192,64,0.3)';ctx.fillRect(rx,H*.91,18,2);}
    ctx.font='18px serif';ctx.fillText('ğŸ§‘â€ğŸ’»',W/2-9,H*.82+Math.sin(t*2)*2);
  },

  // â”€ GAME FLOW â”€
  newGame:function(){
    SFX.click();G.initState();G.s.staff=[G.mkSelf()];G.genProjects();G.genHire();
    G.autoPlay=true;G.staffPos=[];G.autoSpeed=2500;
    if(G.tcId){cancelAnimationFrame(G.tcId);G.tcId=null;}
    q('SCR_TITLE').style.display='none';q('GAME').style.display='flex';
    G.startOC();gLog=[];
    addLog('ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã—ã¦ã®ã‚­ãƒ£ãƒªã‚¢ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆï¼','sys');
    addLog('å£åº§æ®‹é«˜ï¼š38,000å††ã€‚ã¾ãšã¯æ¡ˆä»¶ã‚’å—æ³¨ã—ã‚ˆã†ï¼','sys');
    G.renderAll();G.tab('proj');
    setTimeout(function(){
      var ab=q('btn-auto');if(ab){ab.textContent='â–¶ AUTO';ab.classList.add('on');}
      notify('AUTOé€²è¡ŒON â”€ æ¡ˆä»¶ã‚’å—æ³¨ã—ã¦ã‚¢ã‚µã‚¤ãƒ³ã—ã‚ˆã†ï¼','ok',5000);
      G.scheduleAuto();
    },500);
    window.addEventListener('resize',function(){var cv=q('ocv');if(cv){cv.width=cv.parentElement.clientWidth;cv.height=240;}});
  },

  save:function(){
    SFX.click();
    var d=JSON.parse(JSON.stringify(G.s));
    d.tech=G.s.tech;
    localStorage.setItem('dcfk_v3',JSON.stringify(d));
    notify('ã‚»ãƒ¼ãƒ–ã—ã¾ã—ãŸï¼','ok');SFX.coin();
  },

  load:function(){
    SFX.click();var raw=localStorage.getItem('dcfk_v3');
    if(!raw){notify('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“','warn');return;}
    try{G.initState();var d=JSON.parse(raw);G.s=d;
      G.autoPlay=true;G.staffPos=[];G.autoSpeed=2500;
      if(G.tcId){cancelAnimationFrame(G.tcId);G.tcId=null;}
      q('SCR_TITLE').style.display='none';q('GAME').style.display='flex';
      G.startOC();gLog=[];addLog('ãƒ­ãƒ¼ãƒ‰å®Œäº†ï¼','sys');G.renderAll();G.tab('dash');
      setTimeout(function(){
        var ab=q('btn-auto');if(ab){ab.textContent='â–¶ AUTO';ab.classList.add('on');}
        G.scheduleAuto();
      },500);
      notify('ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼AUTOé€²è¡ŒON','ok');SFX.good();
    }catch(e){notify('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ãŒå£Šã‚Œã¦ã„ã¾ã™','danger');console.error(e);}
  },

  restart:function(){
    q('SCR_END').classList.remove('open');q('GAME').style.display='none';
    q('SCR_TITLE').style.display='flex';
    if(G.ocId){cancelAnimationFrame(G.ocId);G.ocId=null;}
    G.startTC();
  },

  howto:function(){
    alert('ãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾ç™ºå±•å›½ - éŠã³æ–¹\n\nâ–¶ åŸºæœ¬ã®æµã‚Œ\n1.ã€Œæ¡ˆä»¶ã€ã‚¿ãƒ–ã§æ¡ˆä»¶ã‚’é¸ã‚“ã§å—æ³¨\n2.ã€Œåˆ¶ä½œã€ã‚¿ãƒ–ã§ç¤¾å“¡ã‚’ã‚¢ã‚µã‚¤ãƒ³ã™ã‚‹\n3.ã€Œæ¬¡ã®é€±ã¸ã€ãƒœã‚¿ãƒ³ã§æ™‚é–“ã‚’é€²ã‚ã‚‹\n4. æ¡ˆä»¶å®Œäº†â†’è©•ä¾¡ãƒ»å ±é…¬ã‚’å—ã‘å–ã‚‹\n5. åç›Šã§ç¤¾å“¡æ¡ç”¨ãƒ»æŠ€è¡“ç¿’å¾—ãƒ»ã‚ªãƒ•ã‚£ã‚¹æ‹¡å¼µ\n\nâ–¶ é‡è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿\nğŸ’° è³‡é‡‘ï¼šæœˆæ¬¡ã‚³ã‚¹ãƒˆï¼ˆçµ¦ä¸+å®¶è³ƒï¼‰ãŒæ‰•ãˆãªã„ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼\nâ­ è©•åˆ¤ï¼šé«˜ã„ã¨é«˜å˜ä¾¡æ¡ˆä»¶ãŒæ¥ã‚‹\nğŸ”¥ ç‚ä¸Šï¼š90%è¶…ãˆã§ç‚ä¸Šã‚¨ãƒ³ãƒ‰\nğŸ˜ˆ ãƒ–ãƒ©ãƒƒã‚¯åº¦ï¼šé«˜ã„ã¨ç¤¾å“¡ãŒè¾ã‚ã‚‹\n\nâ–¶ ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°7ç¨®\nãƒ»ç¥ã‚¹ã‚¿ã‚¸ã‚ªï¼ˆBestï¼‰ãƒ»ä¸–ç•Œé€²å‡ºãƒ»ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆä¼æ¥­\nãƒ»ä¸Šå ´ãƒ»ç‚ä¸Šè§£æ•£ãƒ»NFTç ´æ»…ãƒ»è³‡é‡‘ã‚·ãƒ§ãƒ¼ãƒˆ\n\nâ–¶ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰\nã‚¹ãƒšãƒ¼ã‚¹: æ¬¡ã®é€±ã¸\n1-7: ã‚¿ãƒ–åˆ‡æ›¿\nCtrl+S: ã‚»ãƒ¼ãƒ–');
  },

  // â”€ TURN ENGINE â”€
  nextTurn:function(){
    if(G.busy)return;G.busy=true;SFX.click();
    var btn=q('btn-turn');btn.disabled=true;btn.textContent='å‡¦ç†ä¸­...';
    G.s.turn++;
    G.s.actives.forEach(function(p){
      var spd=G.projSpeed(p);p.prog=Math.min(100,p.prog+spd);
      if(p.asgn){var s=G.s.staff.find(function(x){return x.id===p.asgn;});if(s)s.mental=clamp(s.mental-3,0,100);}
    });
    var done=G.s.actives.filter(function(p){return p.prog>=100;});
    G.s.actives=G.s.actives.filter(function(p){return p.prog<100;});
    var idx=0;
    function nextDone(){
      if(idx>=done.length){G.doMonthly();return;}
      G.complete(done[idx],function(){idx++;setTimeout(nextDone,120);});
    }
    nextDone();
  },

  doMonthly:function(){
    if(G.s.turn%4===0){
      G.s.monthNum++;
      var sals=G.s.staff.filter(function(s){return!s.isSelf;}).reduce(function(a,s){return a+s.sal;},0);
      var rent=OFFICES[G.s.offLevel].mc,total=sals+rent;
      if(total>0){G.s.money-=total;addLog('æœˆæ¬¡ã‚³ã‚¹ãƒˆï¼šçµ¦ä¸'+fY(sals)+'+å®¶è³ƒ'+fY(rent)+'='+fY(total),'bad');
        if(G.s.money<0)notify('âš  è³‡é‡‘ãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚Šã¾ã—ãŸï¼','danger',5000);
        else if(G.s.money<300000)notify('ğŸ’° è³‡é‡‘ãŒå°‘ãªããªã£ã¦ã„ã¾ã™ï¼','warn',4000);}
      G.s.staff.forEach(function(s){s.mental=clamp(s.mental+12,0,100);});
      G.s.staff.forEach(function(s){if(s.status==='working'){var k=pick(Object.keys(s.stats));s.stats[k]=clamp(s.stats[k]+1,0,99);}});
      var avgM=G.s.staff.reduce(function(a,s){return a+s.mental;},0)/Math.max(1,G.s.staff.length);
      if(avgM<40)G.s.black=clamp(G.s.black+8,0,100);else if(avgM>75)G.s.black=clamp(G.s.black-2,0,100);
      G.genProjects();G.genHire();addLog('æœˆæ¬¡æ›´æ–°ã€‚æ–°æ¡ˆä»¶ãŒå±Šã„ãŸã€‚','sys');
    }
    G.s.avail.forEach(function(p){p.dead--;});
    var exp=G.s.avail.filter(function(p){return p.dead<=0;});
    exp.forEach(function(p){addLog('ã€Œ'+p.nm+'ã€ã®ç· ã‚åˆ‡ã‚ŠãŒéããŸã€‚','bad');});
    G.s.avail=G.s.avail.filter(function(p){return p.dead>0;});
    if(G.s.black>60){var qr=G.s.staff.filter(function(s){return!s.isSelf&&s.mental<30;});
      if(qr.length>0&&Math.random()<0.4){G.showEv(EVTS.find(function(e){return e.id==='quit';}),G.afterEv);return;}}
    if(G.s.fire>=50&&Math.random()<0.2){G.showEv(EVTS.find(function(e){return e.id==='fire_sns';}),G.afterEv);return;}
    if(Math.random()<0.28){G.showEv(pick(EVTS),G.afterEv);return;}
    G.afterEv();
  },

  afterEv:function(){
    G.phaseCheck();if(G.endingCheck())return;
    G.updateHUD();G.renderAll();
    var btn=q('btn-turn');btn.disabled=false;btn.textContent='â–¶â–¶ æ¬¡ã®é€±ã¸';
    G.busy=false;if(G.s.turn%5===0)G.save();
    if(G.autoPlay)G.scheduleAuto();
  },

  // â”€ PROJECT LOGIC â”€
  projSpeed:function(p){
    var base=8;
    if(p.asgn){var s=G.s.staff.find(function(x){return x.id===p.asgn;});
      if(s){base=Math.max(4,Math.round((s.stats.speed+s.stats.design+s.stats.ui)/3*(s.mental/100)));
        if(G.s.tech['design_system'])base=Math.round(base*1.1);
        if(G.s.tech['ux_research']&&(p.tid==='app'||p.tid==='web'))base=Math.round(base*1.1);}}
    return base;
  },

  quality:function(p){
    var q2=50;
    if(p.asgn){var s=G.s.staff.find(function(x){return x.id===p.asgn;});
      if(s){q2=(s.stats.design+s.stats.ui+s.stats.speed)/3*(s.mental/100)*(1+(s.sense||60)/200);
        if(G.s.tech['design_system'])q2*=1.1;
        if(G.s.tech['ux_research']&&(p.tid==='app'||p.tid==='web'))q2*=1.12;
        if(G.s.tech['branding']&&p.tid==='brand')q2*=1.2;}}
    return clamp(Math.round(q2),0,100);
  },

  complete:function(p,cb){
    var qual=G.quality(p);G.s.projDone++;G.s.totalProj++;
    if(Math.random()*100<p.cli.mr){var mod=pick(MODS);G.showMod(mod,p,function(){G.doFinish(p,qual,cb);});return;}
    G.doFinish(p,qual,cb);
  },

  doFinish:function(p,qual,cb){
    var earned=Math.round(p.price*p.cli.pm);
    if(qual>=85)earned=Math.round(earned*1.2);else if(qual<40)earned=Math.round(earned*0.7);
    G.s.money+=earned;G.s.totalRev+=earned;
    G.s.rep=clamp(G.s.rep+Math.floor(qual/14)+p.cli.rg,0,100);
    if(Math.random()<0.3)G.s.sns+=ri(10,55);
    if(p.asgn){var s=G.s.staff.find(function(x){return x.id===p.asgn;});
      if(s){s.status='idle';if(p.sk)p.sk.forEach(function(k){if(s.stats[k]!==undefined)s.stats[k]=clamp(s.stats[k]+ri(1,3),0,99);});}}
    var rv=G.getReview(qual,p.cli);
    G.showRev(rv[0],rv[1],earned,p.tlb,function(){addLog('ã€Œ'+p.nm+'ã€å®Œäº†ï¼'+rv[0]+' +'+fY(earned),'good');SFX.coin();G.updateHUD();if(cb)cb();});
  },

  getReview:function(qual,ct){
    var d=[['â˜…â˜…â˜…â˜…â˜…','å®Œç’§ã§ã™ï¼æ¬¡ã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼'],['â˜…â˜…â˜…â˜…â˜†','ã¨ã¦ã‚‚è‰¯ã‹ã£ãŸã§ã™ã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚'],['â˜…â˜…â˜…â˜†â˜†','ã¾ã‚è‰¯ã‹ã£ãŸã§ã™ï¼ˆãã£ã‘ãªã„ï¼‰'],['â˜…â˜…â˜†â˜†â˜†','ã‚‚ã†ã¡ã‚‡ã£ã¨ä½•ã¨ã‹ãªã‚Šã¾ã›ã‚“ã§ã—ãŸã‹â€¦'],['â˜…â˜†â˜†â˜†â˜†','æ€ã£ã¦ãŸã®ã¨é•ã„ã¾ã—ãŸï¼ˆæœ€åˆã‹ã‚‰è¨€ãˆï¼‰']];
    if(ct.id==='god'&&qual>=70)return['â˜…â˜…â˜…â˜…â˜…','å®Œç’§ã§ã™ï¼SNSã«ä¸Šã’ã¦ã„ã„ã§ã™ã‹ï¼Ÿ'];
    if(ct.id==='pres')return['â˜…â˜…â˜…â˜†â˜†','æ‚ªããªã„ã§ã™ã­ã€‚æ¯å­ã‚‚æ°—ã«å…¥ã£ã¦ã¾ã—ãŸã€‚'];
    if(ct.id==='gov')return['â˜…â˜…â˜…â˜†â˜†','ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚æ¤œåæ›¸ã‚’é€ä»˜ã—ã¾ã™ã€‚'];
    return d[qual>=85?0:qual>=70?1:qual>=55?2:qual>=40?3:4];
  },

  // â”€ ACTIONS â”€
  accept:function(id){
    SFX.click();var p=G.s.avail.find(function(x){return x.id===id;});if(!p)return;
    var mx=Math.max(2,G.s.staff.length);
    if(G.s.actives.length>=mx){notify('åŒæ™‚é€²è¡Œã¯æœ€å¤§'+mx+'ä»¶ã§ã™ï¼','warn');return;}
    var ap=JSON.parse(JSON.stringify(p));ap.prog=0;ap.asgn=null;ap.modCnt=0;
    G.s.actives.push(ap);G.s.avail=G.s.avail.filter(function(x){return x.id!==id;});
    addLog('ã€Œ'+p.nm+'ã€ã‚’å—æ³¨ï¼ç¤¾å“¡ã‚’ã‚¢ã‚µã‚¤ãƒ³ã—ã‚ˆã†ï¼','good');
    notify('ã€Œ'+p.nm+'ã€å—æ³¨ï¼åˆ¶ä½œã‚¿ãƒ–ã§ã‚¢ã‚µã‚¤ãƒ³ã—ã¦ãã ã•ã„ï¼','ok');
    SFX.good();G.renderAll();G.tab('active');
  },

  assign:function(pid,sid){
    SFX.click();var p=G.s.actives.find(function(x){return x.id===pid;});var s=G.s.staff.find(function(x){return x.id===sid;});
    if(!p||!s)return;
    if(s.status==='working'&&p.asgn!==sid){notify(s.nm+'ã¯åˆ¥ã®æ¡ˆä»¶æ‹…å½“ä¸­ã§ã™ï¼','warn');return;}
    if(p.asgn){var prev=G.s.staff.find(function(x){return x.id===p.asgn;});if(prev)prev.status='idle';}
    p.asgn=sid;s.status='working';
    addLog('ã€Œ'+p.nm+'ã€ã«'+s.nm+'ã‚’ã‚¢ã‚µã‚¤ãƒ³','');notify(s.nm+'ã‚’ã‚¢ã‚µã‚¤ãƒ³ã—ã¾ã—ãŸï¼','ok');G.renderAll();
  },

  unassign:function(pid){
    SFX.click();var p=G.s.actives.find(function(x){return x.id===pid;});if(!p)return;
    if(p.asgn){var s=G.s.staff.find(function(x){return x.id===p.asgn;});if(s)s.status='idle';}
    p.asgn=null;notify('ã‚¢ã‚µã‚¤ãƒ³ã‚’è§£é™¤ã—ã¾ã—ãŸ','warn');G.renderAll();
  },

  hire:function(idx){
    SFX.click();var h=G.s.hirePool[idx];if(!h)return;
    var cost=h.sal*2;if(G.s.money<cost){notify('è³‡é‡‘ä¸è¶³ï¼æ¡ç”¨ã‚³ã‚¹ãƒˆï¼š'+fY(cost),'danger');return;}
    var mx=4+G.s.phase*6;if(G.s.staff.length>=mx){notify('ç¤¾å“¡æ•°ä¸Šé™ï¼ˆ'+mx+'åï¼‰ã«é”ã—ã¦ã„ã¾ã™ï¼','warn');return;}
    G.s.money-=cost;
    var emp={id:'e'+Date.now(),nm:h.nm,role:h.role,ic:h.ic,sal:h.sal,stats:JSON.parse(JSON.stringify(h.st)),mental:h.mental,status:'idle',isSelf:false,sense:ri(40,85)};
    G.s.staff.push(emp);G.s.hirePool.splice(idx,1);
    addLog(emp.nm+'ï¼ˆ'+emp.role+'ï¼‰ãŒå…¥ç¤¾ï¼','good');notify(emp.nm+'ãŒå…¥ç¤¾ã—ã¾ã—ãŸï¼æ¡ç”¨ã‚³ã‚¹ãƒˆï¼š'+fY(cost),'ok');
    SFX.good();G.updateHUD();G.renderAll();
  },

  fire:function(id){
    if(!confirm('æœ¬å½“ã«è§£é›‡ã—ã¾ã™ã‹ï¼Ÿ'))return;SFX.click();
    var s=G.s.staff.find(function(x){return x.id===id;});if(!s||s.isSelf)return;
    G.s.actives.forEach(function(p){if(p.asgn===id)p.asgn=null;});
    G.s.staff=G.s.staff.filter(function(x){return x.id!==id;});
    G.s.rep=clamp(G.s.rep-3,0,100);addLog(s.nm+'ãŒé€€è·ã—ãŸã€‚è©•åˆ¤-3ã€‚','bad');
    notify(s.nm+'ãŒé€€è·ã—ã¾ã—ãŸã€‚','warn');SFX.bad();G.updateHUD();G.renderAll();
  },

  unlock:function(id){
    SFX.click();var nd=TECHS.reduce(function(a,r){return a.concat(r.nodes);},[]).find(function(n){return n.id===id;});if(!nd)return;
    if(G.s.tech[id]){notify('æ—¢ã«ç¿’å¾—æ¸ˆã¿ã§ã™','warn');return;}
    if(!nd.req.every(function(r){return G.s.tech[r];})){notify('å‰ææŠ€è¡“ã‚’å…ˆã«ç¿’å¾—ã—ã¦ãã ã•ã„','warn');return;}
    if(G.s.money<nd.cost){notify('è³‡é‡‘ä¸è¶³ï¼å¿…è¦ï¼š'+fY(nd.cost),'danger');return;}
    G.s.money-=nd.cost;G.s.tech[id]=true;
    addLog('æŠ€è¡“ã€Œ'+nd.nm+'ã€ã‚’ç¿’å¾—ï¼'+nd.ef,'good');notify('ã€Œ'+nd.nm+'ã€ã‚’ç¿’å¾—ï¼'+nd.ef,'ok');
    SFX.lvup();G.updateHUD();G.renderTech();
  },

  office:function(lv){
    SFX.click();var od=OFFICES[lv];
    if(G.s.offLevel>=lv){notify('æ—¢ã«ã“ã®ãƒ¬ãƒ™ãƒ«ä»¥ä¸Šã§ã™','warn');return;}
    if(G.s.money<od.cost){notify('è³‡é‡‘ä¸è¶³ï¼å¿…è¦ï¼š'+fY(od.cost),'danger');return;}
    G.s.money-=od.cost;G.s.offLevel=lv;G.s.rep=clamp(G.s.rep+od.rp,0,100);
    addLog('ã‚ªãƒ•ã‚£ã‚¹ã‚’ã€Œ'+od.nm+'ã€ã«ç§»è»¢ï¼è©•åˆ¤+'+od.rp,'good');notify('ã€Œ'+od.nm+'ã€ã«ç§»è»¢ï¼è©•åˆ¤+'+od.rp,'ok');
    q('olb').textContent=OFF_LB[lv];SFX.lvup();G.updateHUD();G.renderProg();
  },

  // â”€ PHASE / ENDING â”€
  phaseCheck:function(){
    var old=G.s.phase;
    if(G.s.totalRev>=50000000&&G.s.staff.length>=8)G.s.phase=Math.max(G.s.phase,3);
    else if(G.s.totalRev>=8000000&&G.s.staff.length>=5)G.s.phase=Math.max(G.s.phase,2);
    else if(G.s.totalRev>=1500000&&G.s.staff.length>=2)G.s.phase=Math.max(G.s.phase,1);
    if(G.s.phase>old){var ns=['å€‹äººäº‹å‹™æ‰€','ãƒ‡ã‚¶ã‚¤ãƒ³äº‹å‹™æ‰€','ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¹ã‚¿ã‚¸ã‚ª','ãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾'];
      addLog('ğŸ‰ ãƒ•ã‚§ãƒ¼ã‚ºã‚¢ãƒƒãƒ—ï¼â†’ã€Œ'+ns[G.s.phase]+'ã€','sys');
      notify('ğŸ‰ PHASE '+G.s.phase+'ã€Œ'+ns[G.s.phase]+'ã€ã¸é€²åŒ–ï¼','ok',5000);
      SFX.lvup();G.genProjects();}
  },

  endingCheck:function(){
    for(var i=0;i<ENDINGS.length;i++){if(ENDINGS[i].cond(G.s)){G.showEnding(ENDINGS[i]);return true;}}return false;
  },

  showEnding:function(e){
    var scr=q('SCR_END');q('end-t').textContent=e.tt;q('end-t').style.color=e.col;q('end-s').textContent=e.story;
    var avgM=G.s.staff.length>0?Math.round(G.s.staff.reduce(function(a,s){return a+s.mental;},0)/G.s.staff.length):0;
    q('end-st').innerHTML='<div class="si">ç´¯è¨ˆåç›Š<b>'+fY(G.s.totalRev)+'</b></div><div class="si">å®Œäº†æ¡ˆä»¶<b>'+G.s.projDone+'ä»¶</b></div><div class="si">ç·ä¿®æ­£å›æ•°<b>'+G.s.totalMods+'å›</b></div><div class="si">å—è³æ­´<b>'+G.s.awards+'ä»¶</b></div><div class="si">æœ€çµ‚ã‚¿ãƒ¼ãƒ³<b>ç¬¬'+G.s.turn+'é€±</b></div><div class="si">ç¤¾å“¡æ•°<b>'+G.s.staff.length+'å</b></div><div class="si">SNS<b>'+G.s.sns.toLocaleString()+'</b></div><div class="si">å¹³å‡ãƒ¡ãƒ³ã‚¿ãƒ«<b>'+avgM+'</b></div>';
    scr.classList.add('open');SFX.fanfare();G.busy=false;
  },

  // â”€ MODALS â”€
  showEv:function(ev,cb){
    if(!ev){if(cb)cb();return;}SFX.ev();
    var mb=q('mbox-ev');mb.className='mbox '+(ev.ty||'');
    q('mev-ic').textContent=ev.ic;q('mev-tt').textContent=ev.tt;q('mev-ds').textContent=ev.ds;
    var el=q('mev-ch');el.innerHTML='';
    ev.ch.forEach(function(c){
      var btn=document.createElement('button');btn.className='mch';
      btn.innerHTML='<span>'+esc(c.tx)+'</span><span class="ef">'+esc(c.ef)+'</span>';
      btn.onclick=function(){SFX.click();try{c.fn();}catch(e2){console.error(e2);}
        q('modal-ev').classList.remove('open');G.updateHUD();G.renderAll();addLog('[ã‚¤ãƒ™ãƒ³ãƒˆ] '+ev.tt,'evt');if(cb)cb();};
      el.appendChild(btn);
    });
    q('modal-ev').classList.add('open');
  },

  showMod:function(mod,proj,cb){
    SFX.alert();proj.modCnt=(proj.modCnt||0)+1;G.s.totalMods++;
    q('mod-cnt').textContent='ç¬¬'+proj.modCnt+'å›';
    q('mod-face').textContent=proj.modCnt<=3?'ğŸ˜¤':proj.modCnt<=6?'ğŸ˜¡':'ğŸ’€';
    q('mod-pn').textContent='ã€Œ'+proj.nm+'ã€';q('mod-tx').textContent=mod.tx;
    var el=q('mod-ch');el.innerHTML='';
    [{tx:mod.at,ef:'ãƒ¡ãƒ³ã‚¿ãƒ«'+mod.dm,fn:function(){if(proj.asgn){var s=G.s.staff.find(function(x){return x.id===proj.asgn;});if(s)s.mental=clamp(s.mental+mod.dm,0,100);}G.s.black=clamp(G.s.black+3,0,100);}},
     {tx:mod.rt,ef:'è©•åˆ¤'+mod.rp,fn:function(){G.s.rep=clamp(G.s.rep+mod.rp,0,100);proj.price=Math.round(proj.price*0.9);}}
    ].forEach(function(c){
      var btn=document.createElement('button');btn.className='mch';
      btn.innerHTML='<span>'+esc(c.tx)+'</span><span class="ef">'+esc(c.ef)+'</span>';
      btn.onclick=function(){SFX.click();c.fn();q('modal-mod').classList.remove('open');G.updateHUD();if(cb)cb();};
      el.appendChild(btn);
    });
    q('modal-mod').classList.add('open');
  },

  showRev:function(stars,comment,earned,typeLb,cb){
    q('rev-st').textContent=stars;q('rev-cm').textContent=comment;
    q('rev-ef').innerHTML='<span style="color:var(--ok)">+'+fY(earned)+'</span>ã€€<span style="color:var(--t3)">'+esc(typeLb)+'æ¡ˆä»¶å®Œäº†</span>';
    q('modal-rev').classList.add('open');G.revCb=cb;
    q('btn-ok-rev').onclick=function(){q('modal-rev').classList.remove('open');SFX.coin();if(G.revCb){G.revCb();G.revCb=null;}};
  },

  // â”€ HUD â”€
  updateHUD:function(){
    q('hco').textContent=G.s.compName||'å€‹äººäº‹å‹™æ‰€';
    var m=G.s.money,hm=q('hmoney');hm.textContent=fY(m).replace('å††','');hm.className='hs-v g'+(m<100000?' blink':'');
    q('hrep').textContent=G.s.rep;
    var hf=q('hfire');hf.textContent=G.s.fire;hf.className='hs-v r'+(G.s.fire>=50?' blink':'');
    q('hsns').textContent=fM(G.s.sns);q('hstaff').textContent=G.s.staff.length;q('hblack').textContent=G.s.black;
    q('hph').textContent='PHASE '+G.s.phase;
    q('olb').textContent=OFF_LB[G.s.offLevel];
    // å¹´æœˆæ—¥è¨ˆç®—: 2025å¹´4æœˆã‚¹ã‚¿ãƒ¼ãƒˆ / 1é€±=7æ—¥
    var startY=2025, startM=4;
    var totalWeeks=G.s.turn-1;
    var totalMonths=Math.floor(totalWeeks/4);
    var weekInMonth=(totalWeeks%4)+1;
    var absMonth=startM-1+totalMonths;
    var dispY=startY+Math.floor(absMonth/12);
    var dispM=(absMonth%12)+1;
    var jpM=['1æœˆ','2æœˆ','3æœˆ','4æœˆ','5æœˆ','6æœˆ','7æœˆ','8æœˆ','9æœˆ','10æœˆ','11æœˆ','12æœˆ'];
    var dm=q('hdate-main'); if(dm)dm.textContent=dispY+'å¹´'+jpM[dispM-1];
    var dd=q('hdate-day'); if(dd)dd.textContent='ç¬¬'+weekInMonth+'é€±';
    var fw=q('wb-fire');if(fw)fw.style.display=G.s.fire>=50?'block':'none';
    var mw=q('wb-money');if(mw)mw.style.display=(G.s.money<200000&&G.s.money>=0)?'block':'none';
    var bp=q('bdg-proj');if(bp)bp.textContent=G.s.avail.length;
    var phN=['å€‹äººäº‹å‹™æ‰€','ãƒ‡ã‚¶ã‚¤ãƒ³äº‹å‹™æ‰€','ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¹ã‚¿ã‚¸ã‚ª','ãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾'];
    var ti=q('tinfo');if(ti){var wInM=(G.s.turn%4||4);var remW=4-wInM;
  ti.innerHTML='<b>'+dispY+'å¹´'+jpM[dispM-1]+'ãƒ»ç¬¬'+weekInMonth+'é€±</b> ï¼ '+phN[Math.min(G.s.phase,3)]+'<br><span class="hint">æœˆæ¬¡ã‚³ã‚¹ãƒˆ ã‚ã¨'+remW+'é€± ï¼ æ¡ˆä»¶'+G.s.avail.length+'ä»¶ ï¼ <kbd>SPACE</kbd> æ¬¡ã®é€± ï¼ <kbd>A</kbd> ã‚ªãƒ¼ãƒˆ</span>';}
  },

  // â”€ TAB â”€
  tab:function(id){
    SFX.click();G.curTab=id;
    document.querySelectorAll('.panel').forEach(function(p){p.classList.remove('on');});
    document.querySelectorAll('.nb').forEach(function(b){b.classList.remove('on');});
    var pan=q('pan-'+id),nav=q('nb-'+id);
    if(pan)pan.classList.add('on');if(nav)nav.classList.add('on');
    switch(id){
      case 'dash':   G.renderDash();break;
      case 'proj':   G.renderProj();break;
      case 'active': G.renderActive();break;
      case 'staff':  G.renderStaff();break;
      case 'hire':   G.renderHire();break;
      case 'tech':   G.renderTech();break;
      case 'prog':   G.renderProg();break;
    }
  },

  renderAll:function(){
    G.updateHUD();renderLog();
    switch(G.curTab){
      case 'dash':   G.renderDash();break;
      case 'proj':   G.renderProj();break;
      case 'active': G.renderActive();break;
      case 'staff':  G.renderStaff();break;
      case 'hire':   G.renderHire();break;
      case 'tech':   G.renderTech();break;
      case 'prog':   G.renderProg();break;
    }
  },

  // â”€ RENDER DASH â”€
  renderDash:function(){
    var avgM=G.s.staff.length>0?Math.round(G.s.staff.reduce(function(a,s){return a+s.mental;},0)/G.s.staff.length):0;
    var stats=[
      {l:'è©•ã€€åˆ¤',v:G.s.rep,mx:100,c:'var(--teal)'},
      {l:'ç‚ä¸Šç‡',v:G.s.fire,mx:100,c:'var(--red)'},
      {l:'SNSãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼',v:G.s.sns,mx:Math.max(10000,G.s.sns),c:'var(--acc2)'},
      {l:'ç¤¾å“¡ãƒ¡ãƒ³ã‚¿ãƒ«å¹³å‡',v:avgM,mx:100,c:avgM<40?'var(--red)':'var(--ok)'},
      {l:'ç´¯è¨ˆåç›Š',v:G.s.totalRev,mx:Math.max(100000000,G.s.totalRev),c:'var(--gold)',fmt:'Y'},
      {l:'ãƒ–ãƒ©ãƒƒã‚¯åº¦',v:G.s.black,mx:100,c:'var(--warn)'},
    ];
    var h='';stats.forEach(function(s){h+='<div class="dc"><div class="dc-l">'+s.l+'</div><div class="dc-v" style="color:'+s.c+'">'+(s.fmt==='Y'?fY(s.v):s.v.toLocaleString())+'</div><div class="dc-b"><div class="dc-bf" style="width:'+Math.min(100,s.v/s.mx*100)+'%;background:'+s.c+'"></div></div></div>';});
    q('dgrid').innerHTML=h;
    var cnt=q('dash-cnt');if(cnt)cnt.textContent=G.s.actives.length+'ä»¶';
    var el=q('dash-ap');if(!el)return;
    if(!G.s.actives.length){el.innerHTML='<div class="empty">é€²è¡Œä¸­ã®æ¡ˆä»¶ãªã—ã€‚<br>æ¡ˆä»¶å—æ³¨ã‚¿ãƒ–ã‹ã‚‰å—æ³¨ã—ã¦ãã ã•ã„ã€‚</div>';return;}
    el.innerHTML=G.s.actives.map(function(p){return G.buildAP(p,true);}).join('');
    renderLog();
  },

  // â”€ RENDER PROJ â”€
  renderProj:function(){
    var hint=q('proj-hint');if(hint)hint.textContent='æ¬¡ã®æ›´æ–°ã¾ã§'+(4-(G.s.turn%4||4))+'é€±';
    var el=q('proj-list');if(!el)return;
    if(!G.s.avail.length){el.innerHTML='<div class="empty">å—æ³¨å¯èƒ½ãªæ¡ˆä»¶ãªã—ã€‚<br>ã€Œæ¬¡ã®é€±ã¸ã€ã§æ–°æ¡ˆä»¶ãŒå±Šãã¾ã™ã€‚</div>';return;}
    var mx=Math.max(2,G.s.staff.length);
    el.innerHTML=G.s.avail.map(function(p){
      return '<div class="pc"><div style="display:flex;justify-content:space-between;margin-bottom:4px"><span class="ptype '+p.tcss+'">'+p.tic+' '+p.tlb+'</span><span class="pst">'+'â˜…'.repeat(p.diff)+'â˜†'.repeat(5-p.diff)+'</span></div>'
        +'<div class="pn">'+esc(p.nm)+'</div>'
        +'<div class="cli '+p.cli.cls+'">'+p.cli.ic+' '+p.cli.lb+'</div>'
        +'<div class="pm"><span>ä¿®æ­£ãƒªã‚¹ã‚¯:'+p.cli.mr+'%</span><span>é›£æ˜“åº¦:'+p.diff+'</span><span>ã€†'+p.dead+'é€±</span></div>'
        +'<div class="pdesc">ã€Œ'+p.cli.desc+'ã€</div>'
        +'<div class="pf"><span class="ppr">'+fY(p.price)+'</span>'
        +'<span class="pdl'+(p.urg?' urg':'')+'">'+( p.urg?'âš¡ç·Šæ€¥ ':'')+p.dead+'é€±</span>'
        +'<button class="btn-acc" '+(G.s.actives.length>=mx?'disabled':'')+' onclick="G.accept(\''+p.id+'\')">å—æ³¨ã™ã‚‹</button></div></div>';
    }).join('');
  },

  // â”€ RENDER ACTIVE â”€
  renderActive:function(){
    var el=q('active-list');if(!el)return;
    if(!G.s.actives.length){el.innerHTML='<div class="empty">é€²è¡Œä¸­ã®æ¡ˆä»¶ãªã—ã€‚<br>æ¡ˆä»¶å—æ³¨ã‚¿ãƒ–ã‹ã‚‰å—æ³¨ã—ã¦ãã ã•ã„ã€‚</div>';return;}
    el.innerHTML=G.s.actives.map(function(p){return G.buildAP(p,false);}).join('');
  },

  buildAP:function(p,compact){
    var assigned=p.asgn?G.s.staff.find(function(s){return s.id===p.asgn;}):null;
    var spd=G.projSpeed(p),left=spd>0?Math.ceil((100-p.prog)/spd):99;
    var html='<div class="ap"><div class="ap-h"><div><span class="ptype '+p.tcss+'" style="font-size:6px;padding:1px 4px">'+p.tic+' '+p.tlb+'</span><div class="ap-n" style="margin-top:3px">'+esc(p.nm)+'</div></div><div style="text-align:right"><div class="ap-pct">'+p.prog+'%</div><div style="font-size:7px;color:var(--t3)">æ®‹ç´„'+left+'é€±</div></div></div>'
      +'<div class="ap-m"><span>'+p.cli.ic+' '+p.cli.lb+'</span><span>'+fY(p.price)+'</span>'+(assigned?'<span>ğŸ‘¤ '+assigned.nm+'</span>':'<span style="color:var(--warn)">âš  æœªã‚¢ã‚µã‚¤ãƒ³</span>')+'<span>ä¿®æ­£'+( p.modCnt||0)+'å›</span></div>'
      +'<div class="apbar"><div class="apbf" style="width:'+p.prog+'%"></div></div>';
    if(!compact){
      var idle=G.s.staff.filter(function(s){return s.status==='idle'||s.id===p.asgn;});
      var chips=idle.map(function(s){var cur=p.asgn===s.id;var busy=s.status==='working'&&!cur;return'<button class="ach'+(cur?' sel':'')+(busy?' bsy':'')+'" onclick="G.assign(\''+p.id+'\',\''+s.id+'\')">'+s.ic+' '+s.nm+'</button>';}).join('');
      var unBtn=assigned?'<button class="ach" style="color:var(--red)" onclick="G.unassign(\''+p.id+'\')">âœ• è§£é™¤</button>':'';
      html+='<div class="apass"><span class="apal">ã‚¢ã‚µã‚¤ãƒ³ï¼š</span>'+chips+unBtn+'</div>';
    }
    html+='</div>';return html;
  },

  // â”€ RENDER STAFF â”€
  renderStaff:function(){
    var cnt=q('staff-cnt');if(cnt)cnt.textContent=G.s.staff.length+'å / ä¸Šé™'+(4+G.s.phase*6)+'å';
    var el=q('staff-list');if(!el)return;
    if(!G.s.staff.length){el.innerHTML='<div class="empty">ç¤¾å“¡ãŒã„ã¾ã›ã‚“</div>';return;}
    el.innerHTML=G.s.staff.map(function(s){
      var dotC=s.mental<30?'var(--red)':s.status==='working'?'var(--acc)':'var(--ok)';
      var mCls='sbf mn'+(s.mental<40?' low':'');
      var stCls=s.mental<30?'st-tire':s.status==='working'?'st-work':'st-idle';
      var stTx=s.mental<30?'ğŸ˜« ç–²å¼Šä¸­':s.status==='working'?'âš™ï¸ åˆ¶ä½œä¸­':'âœ… å¾…æ©Ÿä¸­';
      var ap2=G.s.actives.find(function(p){return p.asgn===s.id;});
      return'<div class="sc"><div class="sc-av">'+s.ic+'<div class="sc-dot" style="background:'+dotC+'"></div></div>'
        +'<div class="sc-b"><div class="sc-n">'+esc(s.nm)+(s.isSelf?' <span style="font-size:7px;color:var(--t3)">(ã‚ãªãŸ)</span>':'')+'</div>'
        +'<div class="sc-r">'+esc(s.role)+(s.isSelf?'':' ï¼ æœˆçµ¦'+fY(s.sal))+'</div>'
        +'<div class="sbars">'
        +'<div class="srow"><span class="sl">ãƒ‡ã‚¶ã‚¤ãƒ³</span><div class="sb"><div class="sbf d" style="width:'+s.stats.design+'%"></div></div><span class="sn">'+s.stats.design+'</span></div>'
        +'<div class="srow"><span class="sl">ã‚¹ãƒ”ãƒ¼ãƒ‰</span><div class="sb"><div class="sbf sp" style="width:'+s.stats.speed+'%"></div></div><span class="sn">'+s.stats.speed+'</span></div>'
        +'<div class="srow"><span class="sl">ãƒ­ã‚¸ãƒƒã‚¯</span><div class="sb"><div class="sbf lg" style="width:'+s.stats.logic+'%"></div></div><span class="sn">'+s.stats.logic+'</span></div>'
        +'<div class="srow"><span class="sl">UIåŠ›</span><div class="sb"><div class="sbf ui" style="width:'+s.stats.ui+'%"></div></div><span class="sn">'+s.stats.ui+'</span></div>'
        +'<div class="srow"><span class="sl">ã‚³ãƒŸãƒ¥åŠ›</span><div class="sb"><div class="sbf cm" style="width:'+s.stats.comm+'%"></div></div><span class="sn">'+s.stats.comm+'</span></div>'
        +'<div class="srow"><span class="sl">ãƒ¡ãƒ³ã‚¿ãƒ«</span><div class="sb"><div class="'+mCls+'" style="width:'+s.mental+'%"></div></div><span class="sn">'+s.mental+'</span></div>'
        +'</div>'
        +'<div class="sc-f"><span class="stbadge '+stCls+'">'+stTx+'</span>'+(ap2?'<span style="font-size:7px;color:var(--acc)">ã€Œ'+ap2.nm+'ã€</span>':'')+(s.mental<40&&!s.isSelf?'<span style="font-size:7px;color:var(--red)">âš  ä¼‘æ¯ãŒå¿…è¦</span>':'')
        +(!s.isSelf?'<button class="btn-fir" onclick="G.fire(\''+s.id+'\')">è§£é›‡</button>':'')+'</div></div></div>';
    }).join('');
  },

  // â”€ RENDER HIRE â”€
  renderHire:function(){
    var el=q('hire-list');if(!el)return;
    if(!G.s.hirePool.length){el.innerHTML='<div class="empty">ç¾åœ¨ã€æ¡ç”¨å€™è£œãŒã„ã¾ã›ã‚“ã€‚<br>æ¬¡ã®æœˆæ¬¡æ›´æ–°ã§å€™è£œãŒå¢—ãˆã¾ã™ã€‚</div>';return;}
    var mx=4+G.s.phase*6;
    el.innerHTML=G.s.hirePool.map(function(h,i){
      var cost=h.sal*2,ok=G.s.money>=cost&&G.s.staff.length<mx;
      return'<div class="hc"><div class="hc-h"><div><div class="hc-n">'+h.ic+' '+esc(h.nm)+'</div><div class="hc-ro">'+esc(h.role)+'</div></div><div class="hc-sl">'+fY(h.sal).replace('å††','')+'<span>/æœˆ</span></div></div>'
        +'<div class="sbars" style="margin-bottom:8px">'
        +'<div class="srow"><span class="sl">ãƒ‡ã‚¶ã‚¤ãƒ³</span><div class="sb"><div class="sbf d" style="width:'+h.st.design+'%"></div></div><span class="sn">'+h.st.design+'</span></div>'
        +'<div class="srow"><span class="sl">ã‚¹ãƒ”ãƒ¼ãƒ‰</span><div class="sb"><div class="sbf sp" style="width:'+h.st.speed+'%"></div></div><span class="sn">'+h.st.speed+'</span></div>'
        +'<div class="srow"><span class="sl">UIåŠ›</span><div class="sb"><div class="sbf ui" style="width:'+h.st.ui+'%"></div></div><span class="sn">'+h.st.ui+'</span></div>'
        +'<div class="srow"><span class="sl">ã‚³ãƒŸãƒ¥åŠ›</span><div class="sb"><div class="sbf cm" style="width:'+h.st.comm+'%"></div></div><span class="sn">'+h.st.comm+'</span></div>'
        +'<div class="srow"><span class="sl">ãƒ¡ãƒ³ã‚¿ãƒ«</span><div class="sb"><div class="sbf mn" style="width:'+h.mental+'%"></div></div><span class="sn">'+h.mental+'</span></div>'
        +'</div>'
        +'<div class="hc-risk">âš  '+esc(h.risk)+'</div>'
        +'<div class="hc-f"><div class="hc-co">æ¡ç”¨ã‚³ã‚¹ãƒˆï¼š'+fY(cost)+'</div>'
        +'<button class="btn-hire" '+(ok?'':'disabled ')+' onclick="G.hire('+i+')">'+(G.s.staff.length>=mx?'å®šå“¡æº€å“¡':G.s.money<cost?'è³‡é‡‘ä¸è¶³':'æ¡ç”¨ã™ã‚‹')+'</button></div></div>';
    }).join('');
  },

  // â”€ RENDER TECH â”€
  renderTech:function(){
    var el=q('tech-tree');if(!el)return;
    var html='';
    TECHS.forEach(function(row){
      html+='<div class="tt-sec"><div class="sh" style="margin-bottom:8px">'+row.row+'</div><div class="tech-row">';
      row.nodes.forEach(function(n){
        var un=!!G.s.tech[n.id];
        var av=!un&&n.req.every(function(r){return G.s.tech[r];});
        var cls=un?'un':av?'av':'lk';
        var oc=av?' onclick="G.unlock(\'' +n.id+ '\')"':'';
        html+='<div class="tn '+cls+'"'+oc+'>';
        html+='<div class="tn-ic">'+n.ic+'</div>';
        html+='<div class="tn-nm">'+esc(n.nm)+'</div>';
        html+='<div class="tn-co">'+(n.cost?fY(n.cost):'ç„¡æ–™')+'</div>';
        html+='<div class="tn-st">'+(un?'âœ“ ç¿’å¾—æ¸ˆã¿':av?'â–¶ ç¿’å¾—å¯èƒ½':'ğŸ”’ è¦å‰æ')+'</div>';
        html+='<div class="tn-ef">'+esc(n.ef)+'</div>';
        html+='<div style="font-size:6px;color:var(--t4);margin-top:1px">'+esc(n.desc)+'</div>';
        html+='</div>';
      });
      html+='</div></div>';
    });
    el.innerHTML=html;
  },

  // â”€ RENDER PROGRESS â”€
  renderProg:function(){
    var phDefs=[{nm:'å€‹äººäº‹å‹™æ‰€',s:'åç›Š150ä¸‡+ç¤¾å“¡2å'},{nm:'ãƒ‡ã‚¶ã‚¤ãƒ³äº‹å‹™æ‰€',s:'åç›Š800ä¸‡+ç¤¾å“¡5å'},{nm:'ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¹ã‚¿ã‚¸ã‚ª',s:'åç›Š5000ä¸‡+ç¤¾å“¡8å'},{nm:'ãƒ‡ã‚¶ã‚¤ãƒ³ä¼šç¤¾',s:'ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ¡ä»¶ã¸'}];
    q('phases').innerHTML=phDefs.map(function(p,i){return'<div class="ph '+(i<G.s.phase?'done':i===G.s.phase?'cur':'')+'"><div class="ph-n">'+(i<G.s.phase?'âœ“':i===G.s.phase?'â—':i)+'</div><div class="ph-nm">'+p.nm+'</div><div class="ph-s">'+p.s+'</div></div>';}).join('');
    q('of-cards').innerHTML=OFFICES.map(function(o,i){var cur=G.s.offLevel===i,past=G.s.offLevel>i,can=G.s.offLevel===i-1;
      return'<div class="ofc'+(cur?' cur':past?' past':'')+'"><div class="ofc-ic">'+o.ic+'</div><div class="ofc-n">'+esc(o.nm)+(cur?' âœ“':'')+'</div><div class="ofc-d">'+esc(o.desc)+'</div><div style="font-size:7px;color:var(--t3);margin-bottom:5px">è©•åˆ¤+'+o.rp+' / å®¶è³ƒ'+fY(o.mc)+'/æœˆ</div><div class="ofc-f"><span class="ofc-p">'+(o.cost?fY(o.cost):'ç„¡æ–™')+'</span>'+(can?'<button class="btn-up" '+(G.s.money<o.cost?'disabled':'')+' onclick="G.office('+i+')">ç§»è»¢ã™ã‚‹</button>':cur?'<span style="font-size:7px;color:var(--teal)">âœ“ ç¾åœ¨åœ°</span>':past?'<span style="font-size:7px;color:var(--t4)">é€šéæ¸ˆã¿</span>':'<span style="font-size:7px;color:var(--t4)">ğŸ”’</span>')+'</div></div>';
    }).join('');
    var avgM=G.s.staff.length>0?Math.round(G.s.staff.reduce(function(a,s){return a+s.mental;},0)/G.s.staff.length):0;
    q('statbox').innerHTML='<div class="si">ç´¯è¨ˆåç›Š<b>'+fY(G.s.totalRev)+'</b></div><div class="si">å®Œäº†æ¡ˆä»¶<b>'+G.s.projDone+'ä»¶</b></div><div class="si">ç·ä¿®æ­£å›æ•°<b>'+G.s.totalMods+'å›</b></div><div class="si">å—è³æ­´<b>'+G.s.awards+'ä»¶</b></div><div class="si">ç¤¾å“¡æ•°<b>'+G.s.staff.length+'å</b></div><div class="si">SNS<b>'+G.s.sns.toLocaleString()+'</b></div><div class="si">å¹³å‡ãƒ¡ãƒ³ã‚¿ãƒ«<b>'+avgM+'</b></div><div class="si">ç¾åœ¨è³‡ç”£<b>'+fY(G.s.money)+'</b></div><div class="si">ç‚ä¸Š<b>'+G.s.fire+'%</b></div><div class="si">ãƒ–ãƒ©ãƒƒã‚¯åº¦<b>'+G.s.black+'%</b></div>';
  },
};

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.addEventListener('load',function(){
  initAC();
  setTimeout(function(){
    q('SCR_LOAD').style.display='none';
    q('SCR_TITLE').style.display='flex';
    G.startTC();
    if(!localStorage.getItem('dcfk_v3')){var bl=document.querySelector('.t-btn.sec');if(bl)bl.style.opacity='.4';}
    var lf=document.createElement('link');lf.rel='stylesheet';lf.href='https://fonts.googleapis.com/css2?family=DotGothic16&display=swap';document.head.appendChild(lf);
  },1700);
});

document.addEventListener('keydown',function(e){
  if(!q('GAME')||q('GAME').style.display==='none')return;
  if(q('modal-ev').classList.contains('open')||q('modal-mod').classList.contains('open')||q('modal-rev').classList.contains('open'))return;
  if(e.key===' '){e.preventDefault();G.nextTurn();}
  else if(e.key==='a'||e.key==='A'){e.preventDefault();G.toggleAuto();}
  else if(e.key==='1')G.tab('dash');
  else if(e.key==='2')G.tab('proj');
  else if(e.key==='3')G.tab('active');
  else if(e.key==='4')G.tab('staff');
  else if(e.key==='5')G.tab('hire');
  else if(e.key==='6')G.tab('tech');
  else if(e.key==='7')G.tab('prog');
  else if((e.ctrlKey||e.metaKey)&&e.key==='s'){e.preventDefault();G.save();}
});

document.addEventListener('click',function(){if(AC&&AC.state==='suspended')AC.resume();},{ once:true });

</script>
</body>
</html>
